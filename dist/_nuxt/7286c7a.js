(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{1709:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return ze})),n.d(t,"b",(function(){return Ue})),n.d(t,"c",(function(){return Me})),n.d(t,"d",(function(){return Fe})),n.d(t,"e",(function(){return Ge})),n.d(t,"f",(function(){return qe})),n.d(t,"g",(function(){return We}));var r=n(14),o=n.n(r),c=n(16),l=n(15),f=n(3),d=n(20),h=n.n(d),y=n(7);function w(e,t,n,r,o,c,l){try{var f=e[c](l),d=f.value}catch(e){return void n(e)}f.done?t(d):Promise.resolve(d).then(r,o)}function k(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var c=e.apply(t,n);function l(e){w(c,r,o,l,f,"next",e)}function f(e){w(c,r,o,l,f,"throw",e)}l(void 0)}))}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function v(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var O=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){var t=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",l=o.asyncIterator||"@@asyncIterator",f=o.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function h(e,t,n,r){var o=t&&t.prototype instanceof S?t:S,c=Object.create(o.prototype),l=new G(r||[]);return c._invoke=function(e,t,n){var r=w;return function(o,c){if(r===m)throw new Error("Generator is already running");if(r===v){if("throw"===o)throw c;return _()}for(n.method=o,n.arg=c;;){var l=n.delegate;if(l){var f=B(l,n);if(f){if(f===O)continue;return f}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===w)throw r=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=m;var d=y(e,t,n);if("normal"===d.type){if(r=n.done?v:k,d.arg===O)continue;return{value:d.arg,done:n.done}}"throw"===d.type&&(r=v,n.method="throw",n.arg=d.arg)}}}(e,n,l),c}function y(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=h;var w="suspendedStart",k="suspendedYield",m="executing",v="completed",O={};function S(){}function T(){}function I(){}var j={};d(j,c,(function(){return this}));var A=Object.getPrototypeOf,P=A&&A(A(N([])));P&&P!==n&&r.call(P,c)&&(j=P);var x=I.prototype=S.prototype=Object.create(j);function K(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function D(e,t){function n(o,c,l,f){var d=y(e[o],e,c);if("throw"!==d.type){var h=d.arg,w=h.value;return w&&"object"==typeof w&&r.call(w,"__await")?t.resolve(w.__await).then((function(e){n("next",e,l,f)}),(function(e){n("throw",e,l,f)})):t.resolve(w).then((function(e){h.value=e,l(h)}),(function(e){return n("throw",e,l,f)}))}f(d.arg)}var o;this._invoke=function(e,r){function c(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(c,c):c()}}function B(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,B(e,n),"throw"===n.method))return O;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return O}var o=y(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,O;var c=o.arg;return c?c.done?(n[e.resultName]=c.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,O):c:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,O)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function W(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function G(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function N(e){if(e){var n=e[c];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:_}}function _(){return{value:t,done:!0}}return T.prototype=I,d(x,"constructor",I),d(I,"constructor",T),T.displayName=d(I,f,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===T||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,I):(e.__proto__=I,d(e,f,"GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},K(D.prototype),d(D.prototype,l,(function(){return this})),e.AsyncIterator=D,e.async=function(t,n,r,o,c){void 0===c&&(c=Promise);var l=new D(h(t,n,r,o),c);return e.isGeneratorFunction(n)?l:l.next().then((function(e){return e.done?e.value:l.next()}))},K(x),d(x,f,"Generator"),d(x,c,(function(){return this})),d(x,"toString",(function(){return"[object Generator]"})),e.keys=function(object){var e=[];for(var t in object)e.push(t);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in object)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,G.prototype={constructor:G,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(W),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return l.type="throw",l.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var c=this.tryEntries[i],l=c.completion;if("root"===c.tryLoc)return o("end");if(c.tryLoc<=this.prev){var f=r.call(c,"catchLoc"),d=r.call(c,"finallyLoc");if(f&&d){if(this.prev<c.catchLoc)return o(c.catchLoc,!0);if(this.prev<c.finallyLoc)return o(c.finallyLoc)}else if(f){if(this.prev<c.catchLoc)return o(c.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return o(c.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var c=o?o.completion:{};return c.type=e,c.arg=t,o?(this.method="next",this.next=o.finallyLoc,O):this.complete(c)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),O},finish:function(e){for(var i=this.tryEntries.length-1;i>=0;--i){var t=this.tryEntries[i];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),W(t),O}},catch:function(e){for(var i=this.tryEntries.length-1;i>=0;--i){var t=this.tryEntries[i];if(t.tryLoc===e){var n=t.completion;if("throw"===n.type){var r=n.arg;W(t)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),O}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}));o.a.config({precision:64,rounding:o.a.ROUND_DOWN,toExpNeg:-64,toExpPos:64});var S,T=new o.a(10),I=new o.a(2).pow(64),j=I.div(2).sub(1),A=I.div(2).neg(),P=I.sub(1),x=I.pow(63).sub(1),K=x.neg(),D=I.pow(64).sub(1),B=40,L=function(){function e(){}return e.from64Buffer=function(e,t){if(void 0===t&&(t=0),8!==e.length&&Object(c.a)(!1),Math.abs(t)<B||Object(c.a)(!1),e[7]>=128){for(var n,r=[],l=v(e);!(n=l()).done;){var f=n.value;r.push(("00"+Math.abs(255&~f).toString(16)).slice(-2))}var d=new h.a(r.join(""),16,"le").add(new h.a(1)).neg();return new o.a(d.toString()).div(T.pow(t))}return new o.a(new h.a(e,"le").toString()).div(T.pow(t))},e.fromU64Buffer=function(e,t){return void 0===t&&(t=0),8!==e.length&&Object(c.a)(!1),Math.abs(t)<B||Object(c.a)(!1),new o.a(new h.a(e,16,"le").toString()).div(T.pow(t))},e.from128Buffer=function(e,t){if(void 0===t&&(t=0),16!==e.length&&Object(c.a)(!1),Math.abs(t)<B||Object(c.a)(!1),e[15]>=128){for(var n,r=[],l=v(e);!(n=l()).done;){var f=n.value;r.push(("00"+Math.abs(255&~f).toString(16)).slice(-2))}var d=new h.a(r.join(""),16,"le").add(new h.a(1)).neg();return new o.a(d.toString()).div(T.pow(t))}return new o.a(new h.a(e,"le").toString()).div(T.pow(t))},e.fromU128Buffer=function(e,t){return void 0===t&&(t=0),16!==e.length&&Object(c.a)(!1),Math.abs(t)<B||Object(c.a)(!1),new o.a(new h.a(e,"le").toString()).div(T.pow(t))},e.to64Buffer=function(e,t){void 0===t&&(t=0),Math.abs(t)<B||Object(c.a)(!1),(e=e.mul(T.pow(t)).round()).greaterThanOrEqualTo(A)&&e.lessThanOrEqualTo(j)||Object(c.a)(!1);var n=new h.a(e.toString());if(n.isNeg()){var r=n.add(new h.a(1)).toBuffer("le",8);return r.forEach((function(e,t,input){input[t]=255&~e})),r}return n.toBuffer("le",8)},e.toU64Buffer=function(e,t){return void 0===t&&(t=0),Math.abs(t)<B||Object(c.a)(!1),(e=e.mul(T.pow(t)).round()).greaterThanOrEqualTo(0)&&e.lessThanOrEqualTo(P)||Object(c.a)(!1),new h.a(e.toString()).toBuffer("le",8)},e.to128Buffer=function(e,t){void 0===t&&(t=0),Math.abs(t)<B||Object(c.a)(!1),(e=e.mul(T.pow(t)).round()).greaterThanOrEqualTo(K)&&e.lessThanOrEqualTo(x)||Object(c.a)(!1);var n=new h.a(e.toString());if(n.isNeg()){var r=n.add(new h.a(1)).toBuffer("le",16);return r.forEach((function(e,t,input){input[t]=255&~e})),r}return n.toBuffer("le",16)},e.toU128Buffer=function(e,t){return void 0===t&&(t=0),Math.abs(t)<B||Object(c.a)(!1),(e=e.mul(T.pow(t)).round()).greaterThanOrEqualTo(0)&&e.lessThanOrEqualTo(D)||Object(c.a)(!1),new h.a(e.toString()).toBuffer("le",16)},e}(),W=function(e){void 0===e&&(e="publicKey");var t=Object(l.blob)(32,e),n=function(e){return{decode:e.decode.bind(e),encode:e.encode.bind(e)}}(t),r=n.encode,o=n.decode,c=t;return c.decode=function(e,t){var n=o(e,t);return new f.PublicKey(n)},c.encode=function(e,t,n){var o=e.toBuffer();return r(o,t,n)},c},G=function(t,n){void 0===t&&(t="uint64"),void 0===n&&(n=0);var r=Object(l.blob)(8,t),o=r.decode.bind(r),c=r.encode.bind(r),f=r;return f.decode=function(t,r){var c=e.from(o(t,r));return L.fromU64Buffer(c,n)},f.encode=function(e,t,r){var o=L.toU64Buffer(e,n);return c(o,t,r)},f},N=function(t,n){void 0===t&&(t="uint64"),void 0===n&&(n=0);var r=Object(l.blob)(16,t),o=r.decode.bind(r),c=r.encode.bind(r),f=r;return f.decode=function(t,r){var c=e.from(o(t,r));return L.from128Buffer(c,n)},f.encode=function(e,t,r){var o=L.to128Buffer(e,n);return c(o,t,r)},f},_=function(t,n){void 0===t&&(t="uint64"),void 0===n&&(n=0);var r=Object(l.blob)(16,t),o=r.decode.bind(r),c=r.encode.bind(r),f=r;return f.decode=function(t,r){var c=e.from(o(t,r));return L.fromU128Buffer(c,n)},f.encode=function(e,t,r){var o=L.toU128Buffer(e,n);return c(o,t,r)},f};function E(e,t){return R.apply(this,arguments)}function R(){return R=k(O.mark((function e(t,n){var r,o,c,l=arguments;return O.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=l.length,o=new Array(r>2?r-2:0),c=2;c<r;c++)o[c-2]=l[c];return e.abrupt("return",Object(f.sendAndConfirmTransaction)(t,n,o,{skipPreflight:!1,commitment:"recent",preflightCommitment:"recent"}));case 2:case"end":return e.stop()}}),e)}))),R.apply(this,arguments)}function U(e,t){return M.apply(this,arguments)}function M(){return(M=k(O.mark((function e(t,n){return O.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.Token.getAssociatedTokenAddress(y.ASSOCIATED_TOKEN_PROGRAM_ID,y.TOKEN_PROGRAM_ID,t,n,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t,n,r){return y.Token.createAssociatedTokenAccountInstruction(y.ASSOCIATED_TOKEN_PROGRAM_ID,y.TOKEN_PROGRAM_ID,e,t,n,r)}function C(e,t){return z.apply(this,arguments)}function z(){return(z=k(O.mark((function e(t,n){var r,o,i,l,f,d,h;return O.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getTokenAccountsByOwner(n,{programId:y.TOKEN_PROGRAM_ID});case 2:for(r=e.sent,o=[],i=0;i<r.value.length;i++)l=r.value[i],f=l.pubkey,null==(null==(d=l.account)?void 0:d.data)&&Object(c.a)(!1),(h=V(d)).address=f,o.push(h);return e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e){null==(null==e?void 0:e.data)&&Object(c.a)(!1);var t=y.AccountLayout.decode(null==e?void 0:e.data);return t.mint=new f.PublicKey(t.mint),t.owner=new f.PublicKey(t.owner),t.amount=y.u64.fromBuffer(t.amount),0===t.delegateOption?(t.delegate=null,t.delegatedAmount=new y.u64(0)):(t.delegate=new f.PublicKey(t.delegate),t.delegatedAmount=y.u64.fromBuffer(t.delegatedAmount)),t.isInitialized=0!==t.state,t.isFrozen=2===t.state,1===t.isNativeOption?(t.rentExemptReserve=y.u64.fromBuffer(t.isNative),t.isNative=!0):(t.rentExemptReserve=null,t.isNative=!1),0===t.closeAuthorityOption?t.closeAuthority=null:t.closeAuthority=new f.PublicKey(t.closeAuthority),t}!function(e){e[e.Initialize=0]="Initialize",e[e.Swap=1]="Swap",e[e.DepositAllTokenTypes=2]="DepositAllTokenTypes",e[e.WithdrawAllTokenTypes=3]="WithdrawAllTokenTypes",e[e.Claim=4]="Claim",e[e.ManagerClaim=5]="ManagerClaim",e[e.AddUserPosition=6]="AddUserPosition",e[e.UpdateFee=7]="UpdateFee",e[e.SimulateSwap=8]="SimulateSwap"}(S||(S={}));var H=Object(l.struct)([Object(l.u8)("instruction")]),J=function(t,n,r){var data=e.alloc(H.span);H.encode({instruction:S.AddUserPosition},data);var o=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:y.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new f.TransactionInstruction({keys:o,programId:t,data:data})},Y=Object(l.struct)([Object(l.u8)("instruction"),G("positionIndex")]),$=function(t,n,r,o,c,l,d,h,w,k,m,v,O){var data=e.alloc(Y.span);Y.encode({instruction:S.Claim,positionIndex:O},data);var T=[{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:k,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:v,isSigner:!1,isWritable:!0},{pubkey:y.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new f.TransactionInstruction({keys:T,programId:t,data:data})},Q=Object(l.struct)([Object(l.u8)("instruction"),Object(l.u8)("isNewPosition"),_("liquityAmount"),Object(l.s32)("tickLower"),Object(l.s32)("tickUpper"),G("maximumTokenA"),G("maximumTokenB"),G("positionIndex")]),X=function(t,n,r,o,c,l,d,h,w,k,m,v,O,T,I,j,A,P,x){var data=e.alloc(Q.span);Q.encode({instruction:S.DepositAllTokenTypes,isNewPosition:O,liquityAmount:j,tickLower:T,tickUpper:I,maximumTokenA:A,maximumTokenB:P,positionIndex:x},data);var K=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:w,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:v,isSigner:!1,isWritable:!0},{pubkey:y.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new f.TransactionInstruction({keys:K,programId:t,data:data})},Z=Object(l.struct)([Object(l.u8)("instruction"),Object(l.u8)("nonce"),Object(l.u8)("curveType"),G("fee",12),G("managerFee",12),Object(l.u32)("tickSpace"),_("currentSqrtPrice",12),_("currentLiquity"),_("feeGrowthGlobal0"),_("feeGrowthGlobal1"),_("managerFeeA"),_("managerFeeB")]),ee=function(t,n,r,c,l,d,h,w,k,m,v,O,T,I,j,A){var data=e.alloc(Z.span);Z.encode({instruction:S.Initialize,nonce:v,curveType:O,fee:T,managerFee:I,tickSpace:j,currentSqrtPrice:A,currentLiquity:new o.a(0),feeGrowthGlobal0:new o.a(0),feeGrowthGlobal1:new o.a(0),managerFeeA:new o.a(0),managerFeeB:new o.a(0)},data);var P=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:h,isSigner:!1,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:k,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:y.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new f.TransactionInstruction({keys:P,programId:t,data:data})},te=Object(l.struct)([Object(l.u8)("instruction")]),ne=function(t,n,r,o,c,l,d,h){var data=e.alloc(te.span);te.encode({instruction:S.ManagerClaim},data);var w=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:y.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new f.TransactionInstruction({keys:w,programId:t,data:data})},re=Object(l.struct)([Object(l.u8)("instruction"),G("amountIn"),G("minimumAmountOut")]),ie=function(t,n,r,o,c,l,d,h,w,k,m){var data=e.alloc(re.span);re.encode({instruction:S.Swap,amountIn:k,minimumAmountOut:m},data);var v=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:w,isSigner:!1,isWritable:!0},{pubkey:y.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new f.TransactionInstruction({keys:v,programId:t,data:data})},ae=Object(l.struct)([Object(l.u8)("instruction"),G("liquityAmount"),G("minimumTokenA"),G("minimumTokenB"),G("positionIndex")]),oe=function(t,n,r,o,c,l,d,h,w,k,m,v,O,T,I,j){var data=e.alloc(ae.span);ae.encode({instruction:S.WithdrawAllTokenTypes,liquityAmount:O,minimumTokenA:T,minimumTokenB:I,positionIndex:j},data);var A=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:v,isSigner:!1,isWritable:!0},{pubkey:y.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new f.TransactionInstruction({keys:A,programId:t,data:data})},ue=Object(l.struct)([Object(l.u8)("instruction"),G("amountIn"),Object(l.u8)("direction")]),se=function(t,n,r,o,c){var data=e.alloc(ue.span);ue.encode({instruction:S.SimulateSwap,amountIn:o,direction:c},data);var l=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0}];return new f.TransactionInstruction({keys:l,programId:t,data:data})},ce=504e3,le=Object(l.struct)([Object(l.s32)("tick"),_("tickPrice",12),_("liquityGross"),N("liquityNet"),_("feeGrowthOutside0",16),_("feeGrowthOutside1",16)],"tickInfo"),pe=Object(l.struct)([Object(l.u8)("swapVersion"),W("tokenSwapKey"),Object(l.u8)("accountType"),Object(l.s32)("len"),Object(l.blob)(503962,"dataFlat")],"ticksAccount"),fe=function(e){return e.data.length===ce},de=function(t,n){if(fe(n)){var r=e.from(n.data),o=pe.decode(r),c=o.swapVersion,f=o.tokenSwapKey,d=o.accountType,h=o.len,y=o.dataFlat,w=h*le.span,k=y.slice(0,w);return{pubkey:t,info:n,data:{swapVersion:c,tokenSwapKey:f,accountType:d,len:h,ticks:Object(l.seq)(le,h).decode(k)}}}},he=36e4,be=Object(l.struct)([W("nftTokenId"),Object(l.s32)("lowerTick"),Object(l.s32)("upperTick"),_("liquity"),_("feeGrowthInsideALast",16),_("feeGrowthInsideBLast",16),_("tokenAFee",16),_("tokenBFee",16)],"position"),ye=Object(l.struct)([Object(l.u8)("swapVersion"),W("tokenSwapKey"),Object(l.u8)("accountType"),Object(l.s32)("len"),Object(l.blob)(359962,"dataFlat")],"positionsAccount"),we=Math.floor(359962/be.span),ke=function(e){return e.data.length===he},me=function(t,n){if(ke(n)){var r=e.from(n.data),o=ye.decode(r),c=o.swapVersion,f=o.tokenSwapKey,d=o.accountType,h=o.len,y=o.dataFlat,w=h*be.span,k=y.slice(0,w);return{pubkey:t,info:n,data:{swapVersion:c,tokenSwapKey:f,accountType:d,len:h,positions:Object(l.seq)(be,h).decode(k)}}}},ge=Object(l.struct)([W("tokenSwapKey"),Object(l.u8)("accountType"),Object(l.u8)("version"),Object(l.u8)("isInitialized"),Object(l.u8)("nonce"),W("tokenProgramId"),W("manager"),W("managerTokenA"),W("managerTokenB"),W("swapTokenA"),W("swapTokenB"),W("tokenAMint"),W("tokenBMint"),W("ticksKey"),W("positionsKey"),Object(l.u8)("curveType"),G("fee",12),G("managerFee",12),Object(l.u32)("tickSpace"),_("currentSqrtPrice",12),_("currentLiquity"),_("feeGrowthGlobal0",16),_("feeGrowthGlobal1",16),_("managerFeeA"),_("managerFeeB")],"tokenSwapAccount"),ve=ge.span,Oe=function(e){return e.data.length===ve},Se=function(t,n){if(Oe(n)){var r=e.from(n.data);return{pubkey:t,info:n,data:ge.decode(r)}}},Te=443632,Ie=-443632,je=new r.Decimal("1.0001"),Ae=new r.Decimal("1e-12"),Pe=je.pow(Te),xe=je.pow(Ie),Ke=je.pow(221816),De=je.pow(-221816);function Be(e){return e.lessThan(Ke)||Object(c.a)(!1),e.greaterThan(De)||Object(c.a)(!1),e.pow(2).log(je).toDP(0,r.Decimal.ROUND_HALF_UP).toNumber()}function Le(e){return e>=Ie&&e<=Te||Object(c.a)(!1),je.pow(e/2)}function qe(e){return e.lessThan(Pe)||Object(c.a)(!1),e.greaterThan(xe)||Object(c.a)(!1),e.log(je).toDP(0,r.Decimal.ROUND_HALF_UP).toNumber()}function We(e){return e>=Ie&&e<=Te||Object(c.a)(!1),je.pow(e)}function Ge(e,t){t>0&&t%1==0||Object(c.a)(!1),e.lessThan(Pe)||Object(c.a)(!1),e.greaterThan(xe)||Object(c.a)(!1);var n=qe(e),r=(n-Ie)%t;return r>t/2?n-r+t:n-r}function Ne(e,t,n){return n.div(e).toDP(0,r.Decimal.ROUND_DOWN).sub(n.div(t).toDP(0,r.Decimal.ROUND_DOWN))}function _e(e,t,n){return n.mul(t.sub(e)).toDP(0,r.Decimal.ROUND_DOWN)}function Ee(e,t,n){var o=t.div(n.add(t.div(e))),c=n.add(t.div(e).toDP(0,r.Decimal.ROUND_DOWN));return{amountOut:t.mul(e).toDP(0,r.Decimal.ROUND_DOWN).sub(t.mul(t).div(c).toDP(0,r.Decimal.ROUND_DOWN)),afterSqrtPrice:o}}function Re(e,t,n){var o=n.div(t).add(e),c=n.add(t.mul(e).toDP(0,r.Decimal.ROUND_DOWN));return{amountOut:t.div(e).toDP(0,r.Decimal.ROUND_DOWN).sub(t.mul(t).div(c).toDP(0,r.Decimal.ROUND_DOWN)),afterSqrtPrice:o}}function Ue(e,t,n,r,l){e<t||Object(c.a)(!1);var f=Le(e),d=Le(t);r.greaterThanOrEqualTo(f)&&r.lessThanOrEqualTo(d)||Object(c.a)(!1);var h=new o.a(1);if(0===l){var y=n.div(h.div(r).sub(h.div(d)));return{desiredAmountDst:y.mul(r.sub(f)),deltaLiquity:y}}var w=n.div(r.sub(f));return{desiredAmountDst:w.mul(h.div(r).sub(h.div(d))),deltaLiquity:w}}function Me(e,t,n){e<t||Object(c.a)(!1);var r=Le(e),l=Le(t),f=new o.a(1);return n.div(f.div(r).sub(f.div(l)))}function Fe(e,t,n){e<t||Object(c.a)(!1);var r=Le(e),o=Le(t);return n.div(o.sub(r))}var Ce=new f.PublicKey("11111111111111111111111111111111");o.a.config({precision:64,rounding:o.a.ROUND_HALF_DOWN,toExpNeg:-64,toExpPos:64});var ze=function(){function e(e,t,n,r){this.programId=Ce,this.tokenSwapKey=Ce,this.authority=Ce,this.isLoaded=!1,this.currentTick=0,this.tokenSwapInfo={tokenSwapKey:Ce,accountType:0,version:0,isInitialized:0,nonce:0,tokenProgramId:y.TOKEN_PROGRAM_ID,manager:Ce,managerTokenA:Ce,managerTokenB:Ce,swapTokenA:Ce,swapTokenB:Ce,tokenAMint:Ce,tokenBMint:Ce,ticksKey:Ce,positionsKey:Ce,curveType:0,fee:new o.a(0),managerFee:new o.a(0),tickSpace:0,currentSqrtPrice:new o.a(0),currentLiquity:new o.a(0),feeGrowthGlobal0:new o.a(0),feeGrowthGlobal1:new o.a(0),managerFeeA:new o.a(0),managerFeeB:new o.a(0)},this.ticks=[],this.conn=e,this.tokenSwapKey=n,this.programId=t,this.payer=r,this.positions=new Map,this.positionsKeys=new Map}var t=e.prototype;return t.setDefaultPayer=function(e){this.payer=e},t.load=function(){var e=k(O.mark((function e(){var t,n,r,l=this;return O.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={encoding:"base64",filters:[{memcmp:{offset:1,bytes:this.tokenSwapKey.toBase58()}}]},e.next=3,this.conn.getProgramAccounts(this.programId,t);case 3:if(e.sent.map((function(e){if(Oe(e.account)){var t=Se(e.pubkey,e.account);void 0===(null==t?void 0:t.data)&&Object(c.a)(!1),l.tokenSwapInfo=t.data}else if(fe(e.account)){var n=de(e.pubkey,e.account);void 0===(null==n?void 0:n.data)&&Object(c.a)(!1),l.ticks=n.data.ticks}else if(ke(e.account)){var r=me(e.pubkey,e.account);void 0===(null==r?void 0:r.data)&&Object(c.a)(!1),l.positionsKeys.set(e.pubkey,r.data.positions.length);for(var i=0;i<r.data.positions.length;i++){var p=r.data.positions[i];l.positions.set(p.nftTokenId.toBase58(),{positionsKey:e.pubkey,index:new o.a(i),positionId:p.nftTokenId,lowerTick:p.lowerTick,upperTick:p.upperTick,liquity:p.liquity,feeGrowthInsideALast:p.feeGrowthInsideALast,feeGrowthInsideBLast:p.feeGrowthInsideBLast,tokenAFee:p.tokenAFee,tokenBFee:p.tokenBFee})}}else console.log("the account:%s length:%d unkown",e.pubkey.toString(),e.account.data.length)})),this.authority.toString()!==Ce.toString()){e.next=11;break}return e.next=8,f.PublicKey.findProgramAddress([this.tokenSwapKey.toBuffer()],this.programId);case 8:n=e.sent,r=n[0],this.authority=r;case 11:return this.isLoaded=!0,this.currentTick=Be(this.tokenSwapInfo.currentSqrtPrice),e.abrupt("return",this);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.createTokenSwap=function(){var t=k(O.mark((function t(n,r,o,c,l,d,h,w,k,m,v){var S,T,I,j,A,P,x,K,D,B,L,W,G,N,_,R,M,C;return O.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===v&&(v=!1),S=f.Keypair.generate(),T=f.Keypair.generate(),I=f.Keypair.generate(),t.next=6,f.PublicKey.findProgramAddress([S.publicKey.toBuffer()],r);case 6:return j=t.sent,A=j[0],P=j[1],t.next=11,n.getMinimumBalanceForRentExemption(ce);case 11:return x=t.sent,t.next=14,n.getMinimumBalanceForRentExemption(he);case 14:return K=t.sent,t.next=17,n.getMinimumBalanceForRentExemption(ve);case 17:return D=t.sent,B=(new f.Transaction).add(f.SystemProgram.createAccount({fromPubkey:m.publicKey,newAccountPubkey:S.publicKey,lamports:D,space:ve,programId:r}),f.SystemProgram.createAccount({fromPubkey:m.publicKey,newAccountPubkey:T.publicKey,lamports:x,space:ce,programId:r}),f.SystemProgram.createAccount({fromPubkey:m.publicKey,newAccountPubkey:I.publicKey,lamports:K,space:he,programId:r})),t.next=21,U(o,A);case 21:return L=t.sent,t.next=24,U(c,A);case 24:return W=t.sent,B.add(F(o,L,A,m.publicKey),F(c,W,A,m.publicKey)),G=k.sqrt(),N=new y.Token(n,o,y.TOKEN_PROGRAM_ID,m),_=new y.Token(n,c,y.TOKEN_PROGRAM_ID,m),t.next=31,N.getOrCreateAssociatedAccountInfo(l);case 31:return R=t.sent,t.next=34,_.getOrCreateAssociatedAccountInfo(l);case 34:return M=t.sent,0,B.add(ee(r,S.publicKey,A,l,R.address,M.address,L,W,T.publicKey,I.publicKey,P,0,d,h,w,G)),t.next=39,E(n,B,m,S,T,I);case 39:return C=t.sent,v&&console.log(C),t.next=43,new e(n,r,S.publicKey,m).load();case 43:return t.abrupt("return",t.sent);case 44:case"end":return t.stop()}}),t)})));return function(e,n,r,o,c,l,f,d,h,y,w){return t.apply(this,arguments)}}(),t.mintPosition=function(){var e=k(O.mark((function e(t,n,r,l,d,h,w,k,m){var v,S,T,I,j;return O.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===m&&(m=null),!this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return r<l||Object(c.a)(!1),null==(m=null!=m?m:this.payer)&&Object(c.a)(!1),v=f.Keypair.generate(),e.next=10,U(v.publicKey,m.publicKey);case 10:return S=e.sent,e.next=13,y.Token.getMinBalanceRentForExemptAccount(this.conn);case 13:return T=e.sent,null==(I=this.choosePosition())&&Object(c.a)(!1),(j=new f.Transaction).add(f.SystemProgram.createAccount({fromPubkey:m.publicKey,newAccountPubkey:v.publicKey,lamports:T,space:y.MintLayout.span,programId:y.TOKEN_PROGRAM_ID}),y.Token.createInitMintInstruction(y.TOKEN_PROGRAM_ID,v.publicKey,0,this.authority,null),F(v.publicKey,S,m.publicKey,m.publicKey)),j.add(X(this.programId,this.tokenSwapKey,this.authority,k.publicKey,t,n,this.tokenSwapInfo.swapTokenA,this.tokenSwapInfo.swapTokenB,v.publicKey,S,this.tokenSwapInfo.ticksKey,I,0,r,l,d,h,w,new o.a(0))),e.next=21,E(this.conn,j,m,k,v);case 21:return e.abrupt("return",e.sent);case 22:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,c,l,f,d,h){return e.apply(this,arguments)}}(),t.increaseLiquity=function(){var e=k(O.mark((function e(t,n,r,o,l,d,h){var w,k,m,v;return O.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===h&&(h=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null==(w=this.getPositionInfo(t))&&Object(c.a)(!1),null===(h=null!=h?h:this.payer)&&Object(c.a)(!1),k=new y.Token(this.conn,t,y.TOKEN_PROGRAM_ID,h),e.t0=k,e.next=12,U(k.publicKey,h.publicKey);case 12:return e.t1=e.sent,e.next=15,e.t0.getAccountInfo.call(e.t0,e.t1);case 15:return 1!==(m=e.sent).amount.toNumber()&&Object(c.a)(!1),(v=new f.Transaction).add(X(this.programId,this.tokenSwapKey,this.authority,h.publicKey,n,r,this.tokenSwapInfo.swapTokenA,this.tokenSwapInfo.swapTokenB,t,m.address,this.tokenSwapInfo.ticksKey,w.positionsKey,1,w.lowerTick,w.upperTick,o,l,d,w.index)),e.next=21,E(this.conn,v,h);case 21:return e.abrupt("return",e.sent);case 22:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,c,l,f){return e.apply(this,arguments)}}(),t.decreaseLiquity=function(){var e=k(O.mark((function e(t,n,r,o,l,d,h){var w,k,m,v;return O.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===h&&(h=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null==(w=this.getPositionInfo(t))&&Object(c.a)(!1),null===(h=null!=h?h:this.payer)&&Object(c.a)(!1),k=new y.Token(this.conn,t,y.TOKEN_PROGRAM_ID,h),e.t0=k,e.next=12,U(k.publicKey,h.publicKey);case 12:return e.t1=e.sent,e.next=15,e.t0.getAccountInfo.call(e.t0,e.t1);case 15:return 1!==(m=e.sent).amount.toNumber()&&Object(c.a)(!1),v=(new f.Transaction).add(oe(this.programId,this.tokenSwapKey,this.authority,h.publicKey,this.tokenSwapInfo.swapTokenA,this.tokenSwapInfo.swapTokenB,n,r,t,m.address,this.tokenSwapInfo.ticksKey,w.positionsKey,o,l,d,w.index)),e.next=20,E(this.conn,v,h);case 20:return e.abrupt("return",e.sent);case 21:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,c,l,f){return e.apply(this,arguments)}}(),t.swap=function(){var e=k(O.mark((function e(t,n,r,o,l,d,h){var y,w,k,m;return O.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===h&&(h=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null===(h=null!=h?h:this.payer)&&Object(c.a)(!1),y=1===r?{swapSrc:this.tokenSwapInfo.swapTokenA,swapDst:this.tokenSwapInfo.swapTokenB}:{swapSrc:this.tokenSwapInfo.swapTokenB,swapDst:this.tokenSwapInfo.swapTokenA},w=y.swapSrc,k=y.swapDst,m=(new f.Transaction).add(ie(this.programId,this.tokenSwapKey,this.authority,d.publicKey,t,n,w,k,this.tokenSwapInfo.ticksKey,o,l)),e.next=10,E(this.conn,m,h,d);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,c,l,f){return e.apply(this,arguments)}}(),t.simulateSwap=function(){var e=k(O.mark((function e(t,n,r){var o,c;return O.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isLoaded){e.next=3;break}return e.next=3,this.load();case 3:return o=(new f.Transaction).add(se(this.programId,this.tokenSwapKey,this.tokenSwapInfo.ticksKey,t,n)),e.next=6,this.conn.simulateTransaction(o,[r]);case 6:c=e.sent,console.log(c);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.collect=function(){var e=k(O.mark((function e(t,n,r,o){var l,d,h,w;return O.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===o&&(o=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null==(l=this.getPositionInfo(t))&&Object(c.a)(!1),null===(o=null!=o?o:this.payer)&&Object(c.a)(!1),d=new y.Token(this.conn,t,y.TOKEN_PROGRAM_ID,o),e.t0=d,e.next=12,U(d.publicKey,o.publicKey);case 12:return e.t1=e.sent,e.next=15,e.t0.getAccountInfo.call(e.t0,e.t1);case 15:return 1!==(h=e.sent).amount.toNumber()&&Object(c.a)(!1),w=(new f.Transaction).add($(this.programId,this.tokenSwapKey,this.authority,o.publicKey,this.tokenSwapInfo.swapTokenB,this.tokenSwapInfo.swapTokenB,n,r,t,h.address,this.tokenSwapInfo.ticksKey,l.positionsKey,l.index)),e.next=20,E(this.conn,w,o);case 20:return e.abrupt("return",e.sent);case 21:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o){return e.apply(this,arguments)}}(),t.managerCollect=function(){var e=k(O.mark((function e(t,n,r){var o;return O.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null===(r=null!=r?r:this.payer)&&Object(c.a)(!1),o=(new f.Transaction).add(ne(this.programId,this.tokenSwapKey,this.authority,r.publicKey,this.tokenSwapInfo.swapTokenA,this.tokenSwapInfo.swapTokenB,t,n)),e.next=9,E(this.conn,o,r);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.addPositionsAccount=function(){var e=k(O.mark((function e(t){var n,r,o;return O.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null===(t=null!=t?t:this.payer)&&Object(c.a)(!1),n=f.Keypair.generate(),e.next=9,this.conn.getMinimumBalanceForRentExemption(he);case 9:return r=e.sent,o=(new f.Transaction).add(f.SystemProgram.createAccount({fromPubkey:t.publicKey,newAccountPubkey:n.publicKey,lamports:r,space:he,programId:this.programId}),J(this.programId,this.authority,n.publicKey)),e.next=13,E(this.conn,o,t,n);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.approve=function(){var e=k(O.mark((function e(t,n,r,o,l){var f;return O.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===l&&(l=null),null===(l=null!=l?l:this.payer)&&Object(c.a)(!1),f=new y.Token(this.conn,n,y.TOKEN_PROGRAM_ID,l),e.next=6,f.approve(t,o.publicKey,l,[],r.toNumber());case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,c){return e.apply(this,arguments)}}(),t.getUserPositions=function(){var e=k(O.mark((function e(t){var n,r,o,i,l;return O.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=void 0),this.isLoaded||Object(c.a)(!1),void 0===(t=null!=t?t:null==(n=this.payer)?void 0:n.publicKey)&&Object(c.a)(!1),e.next=6,C(this.conn,t);case 6:for(r=e.sent,o=[],i=0;i<r.length;i++)void 0!==(l=this.positions.get(r[i].mint.toBase58()))&&o.push(l);return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.calculateLiquityByTokenA=function(e,t,n){if(this.isLoaded||Object(c.a)(!1),this.currentTick<=t||Object(c.a)(!1),this.currentTick<e)return{desiredAmountB:new o.a(0),liquity:Me(e,t,n)};var r=Ue(e,t,n,this.tokenSwapInfo.currentSqrtPrice,0);return{desiredAmountB:r.desiredAmountDst,liquity:r.deltaLiquity}},t.calculateLiquityByTokenB=function(e,t,n){if(this.isLoaded||Object(c.a)(!1),this.currentTick>=e||Object(c.a)(!1),this.currentTick<t)return{desiredAmountA:new o.a(0),liquity:Fe(e,t,n)};var r=Ue(e,t,n,this.tokenSwapInfo.currentSqrtPrice,1);return{desiredAmountA:r.desiredAmountDst,liquity:r.deltaLiquity}},t.calculatePositionValue=function(e){this.isLoaded||Object(c.a)(!1);var t=this.getPositionInfo(e);void 0===t&&Object(c.a)(!1);var n,r,l,f,d,h,y=(n=t.lowerTick,r=t.upperTick,l=t.liquity,f=this.tokenSwapInfo.currentSqrtPrice,d=Le(n),h=Le(r),f.lessThan(d)?{amountA:l.div(d).sub(l.div(h)),amountB:new o.a(0)}:f.greaterThan(h)?{amountA:new o.a(0),amountB:l.mul(h).sub(l.mul(d))}:{amountA:l.div(f).sub(l.div(h)),amountB:l.mul(f).sub(l.mul(d))}),w=y.amountA,k=y.amountB;return{liquity:t.liquity,amountA:w,amountB:k}},t.preCollect=function(e){this.isLoaded||Object(c.a)(!1);var t=this.getPositionInfo(e);void 0===t&&Object(c.a)(!1);for(var n=null,r=null,i=0;i<this.ticks.length;i++)this.ticks[i].tick==t.lowerTick&&(n=this.ticks[i]),this.ticks[i].tick==t.upperTick&&(r=this.ticks[i]);null===n&&Object(c.a)(!1),null===r&&Object(c.a)(!1);var l=new o.a(0),f=new o.a(0),d=new o.a(0),h=new o.a(0),y=this.tokenSwapInfo.currentSqrtPrice;return n.tickPrice.lessThan(y)?(l=n.feeGrowthOutside0,f=n.feeGrowthOutside1):(l=this.tokenSwapInfo.feeGrowthGlobal0.sub(n.feeGrowthOutside0),f=this.tokenSwapInfo.feeGrowthGlobal1.sub(n.feeGrowthOutside1)),r.tickPrice.lessThan(y)?(d=this.tokenSwapInfo.feeGrowthGlobal0.sub(r.feeGrowthOutside0),h=this.tokenSwapInfo.feeGrowthGlobal1.sub(r.feeGrowthOutside1)):(d=r.feeGrowthOutside0,h=r.feeGrowthOutside1),{amountA:this.tokenSwapInfo.feeGrowthGlobal0.sub(l).sub(d).sub(t.feeGrowthInsideALast).mul(t.liquity),amountB:this.tokenSwapInfo.feeGrowthGlobal1.sub(f).sub(h).sub(t.feeGrowthInsideBLast).mul(t.liquity)}},t.preSwapA=function(e){this.isLoaded||Object(c.a)(!1);var t=function(e,t,n,o,l){l.greaterThan(new r.Decimal(0))||Object(c.a)(!1),o.greaterThanOrEqualTo(new r.Decimal(0))||Object(c.a)(!1),e.length>0||Object(c.a)(!1),t>e[0].tickPrice||Object(c.a)(!1);for(var f=o,d=new r.Decimal(0),h=l,y=new r.Decimal(0),w=new r.Decimal(0),k=new r.Decimal(0),i=e.length-1;i>=0;i--)if(f.equals(new r.Decimal(0)))t=e[i].tickPrice.sub(Ae),f=f.sub(e[i].liquityNet);else if(!(t<e[i].tickPrice)){var m=t,v=e[i].tickPrice,O=Ne(v,t,f),S=O.mul(n).toDP(0,r.Decimal.ROUND_DOWN);if(y=h.lessThan(S)?h:h.sub(S),O.greaterThanOrEqualTo(y)){var T=Ee(m,f,y=h.mul(new r.Decimal(1).sub(n)).toDP(0,r.Decimal.ROUND_UP)),I=T.amountOut,j=T.afterSqrtPrice;return k=k.add(h),w=w.add(h.sub(y)),{amountOut:d.add(I),amountUsed:k,feeUsed:w,afterPrice:j,afterLiquity:f}}h=y.sub(O),k=k.add(O).add(S),w=w.add(S),d=d.add(_e(v,m,f)),f=f.sub(e[i].liquityNet),t=e[i].tickPrice.sub(Ae)}return{amountOut:d,amountUsed:k,feeUsed:w,afterPrice:t,afterLiquity:f}}(this.ticks,this.tokenSwapInfo.currentSqrtPrice,this.tokenSwapInfo.fee,this.tokenSwapInfo.currentLiquity,e),n=this.tokenSwapInfo.currentSqrtPrice.pow(2),l=t.afterPrice.pow(2),f=l.sub(n).div(n).abs(),d=new o.a(1),h=d.div(n),y=d.div(l).sub(h).div(h).abs();return{amountOut:t.amountOut,amountUsed:t.amountUsed,feeUsed:t.feeUsed,afterPrice:t.afterPrice,afterLiquity:t.afterLiquity,impactA:f,impactB:y}},t.preSwapB=function(e){this.isLoaded||Object(c.a)(!1);var t=function(e,t,n,o,l){l.greaterThan(new r.Decimal(0))||Object(c.a)(!1),o.greaterThanOrEqualTo(new r.Decimal(0))||Object(c.a)(!1),e.length>0||Object(c.a)(!1),t.lessThan(e[e.length-1].tickPrice)||Object(c.a)(!1);for(var f=o,d=new r.Decimal(0),h=l,y=new r.Decimal(0),w=new r.Decimal(0),k=new r.Decimal(0),i=0;i<e.length;i++)if(f.equals(new r.Decimal(0)))t=e[i].tickPrice.add(Ae),f=f.add(e[i].liquityNet);else if(!(t>e[i].tickPrice)){var m=e[i].tickPrice,v=_e(t,m,f),O=v.mul(n).toDP(0,r.Decimal.ROUND_DOWN);if(y=h.lessThan(O)?h:h.sub(O),v.greaterThanOrEqualTo(y)){var S=Re(t,f,y=h.mul(new r.Decimal(1).sub(n)).toDP(0,r.Decimal.ROUND_UP)),T=S.amountOut,I=S.afterSqrtPrice;return w=w.add(h),k=k.add(h.sub(y)),{amountOut:d.add(T),feeUsed:k,amountUsed:w,afterPrice:I.pow(2),afterLiquity:f}}h=y.sub(v),w=w.add(v).add(O),k=k.add(O),d=d.add(Ne(t,m,f)),f=f.add(e[i].liquityNet),t=e[i].tickPrice.add(Ae)}return{amountOut:d,amountUsed:w,feeUsed:k,afterPrice:t,afterLiquity:f}}(this.ticks,this.tokenSwapInfo.currentSqrtPrice,this.tokenSwapInfo.fee,this.tokenSwapInfo.currentLiquity,e),n=this.tokenSwapInfo.currentSqrtPrice.pow(2),l=t.afterPrice.pow(2),f=l.sub(n).div(n).abs(),d=new o.a(1),h=d.div(n),y=d.div(l).sub(h).div(h).abs();return{amountOut:t.amountOut,amountUsed:t.amountUsed,feeUsed:t.feeUsed,afterPrice:t.afterPrice,afterLiquity:t.afterLiquity,impactA:f,impactB:y}},t.getNearestTickByPrice=function(e){return this.isLoaded||Object(c.a)(!1),Ge(e,this.tokenSwapInfo.tickSpace)},t.getPositionInfo=function(e){return this.isLoaded||Object(c.a)(!1),this.positions.get(e.toBase58())},t.choosePosition=function(){this.isLoaded||Object(c.a)(!1);for(var e,t=v(this.positionsKeys);!(e=t()).done;){var n=e.value,r=n[0];if(n[1]<we)return r}return null},t.log=function(){var e=null!==this.payer?this.payer.publicKey.toBase58():"null";console.log(JSON.stringify({programId:this.programId.toString(),tokenSwapKey:this.tokenSwapKey.toString(),payer:e,authority:this.authority.toString(),currentTick:this.currentTick,currentPrice:this.tokenSwapInfo.currentSqrtPrice.pow(2).toString(),tokenSwapInfo:{accountType:this.tokenSwapInfo.accountType,version:this.tokenSwapInfo.version,isInitialized:this.tokenSwapInfo.isInitialized,nonce:this.tokenSwapInfo.nonce,manager:this.tokenSwapInfo.manager.toString(),managerTokenA:this.tokenSwapInfo.managerTokenA.toString(),managerTokenB:this.tokenSwapInfo.managerTokenB.toString(),swapTokenA:this.tokenSwapInfo.swapTokenA.toString(),swapTokenB:this.tokenSwapInfo.swapTokenB.toString(),tokenAMint:this.tokenSwapInfo.tokenAMint.toString(),tokenBMint:this.tokenSwapInfo.tokenBMint.toString(),ticksKey:this.tokenSwapInfo.ticksKey.toString(),positionsKey:this.tokenSwapInfo.positionsKey.toString(),curveType:this.tokenSwapInfo.curveType,fee:this.tokenSwapInfo.fee,managerFee:this.tokenSwapInfo.managerFee,tickSpace:this.tokenSwapInfo.tickSpace,currentSqrtPrice:this.tokenSwapInfo.currentSqrtPrice,currentLiquity:this.tokenSwapInfo.currentLiquity,feeGrowthGlobal0:this.tokenSwapInfo.feeGrowthGlobal0,feeGrowthGlobal1:this.tokenSwapInfo.feeGrowthGlobal1,managerFeeA:this.tokenSwapInfo.managerFeeA,managerFeeB:this.tokenSwapInfo.managerFeeB},positions:Object.fromEntries(this.positions),positionsKeys:Object.fromEntries(this.positionsKeys),ticks:this.ticks},null,4))},e}()}).call(this,n(5).Buffer)}}]);