(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{1968:function(e,t,n){"use strict";(function(e,r){n.d(t,"a",(function(){return Ye}));var o=n(51),c=n.n(o),l=n(81),f=n(9),d=n(0),h=n(11),y=n.n(h),w=n(1969),k=n.n(w),m=n(7),v=n(1970),S=n.n(v);function O(e,t,n,r,o,c,l){try{var f=e[c](l),d=f.value}catch(e){return void n(e)}f.done?t(d):Promise.resolve(d).then(r,o)}function T(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var c=e.apply(t,n);function l(e){O(c,r,o,l,f,"next",e)}function f(e){O(c,r,o,l,f,"throw",e)}l(void 0)}))}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function j(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var A=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){var t=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",l=o.asyncIterator||"@@asyncIterator",f=o.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function h(e,t,n,r){var o=t&&t.prototype instanceof O?t:O,c=Object.create(o.prototype),l=new G(r||[]);return c._invoke=function(e,t,n){var r=w;return function(o,c){if(r===m)throw new Error("Generator is already running");if(r===v){if("throw"===o)throw c;return N()}for(n.method=o,n.arg=c;;){var l=n.delegate;if(l){var f=L(l,n);if(f){if(f===S)continue;return f}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===w)throw r=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=m;var d=y(e,t,n);if("normal"===d.type){if(r=n.done?v:k,d.arg===S)continue;return{value:d.arg,done:n.done}}"throw"===d.type&&(r=v,n.method="throw",n.arg=d.arg)}}}(e,n,l),c}function y(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=h;var w="suspendedStart",k="suspendedYield",m="executing",v="completed",S={};function O(){}function T(){}function I(){}var j={};d(j,c,(function(){return this}));var A=Object.getPrototypeOf,x=A&&A(A(F([])));x&&x!==n&&r.call(x,c)&&(j=x);var K=I.prototype=O.prototype=Object.create(j);function B(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function P(e,t){function n(o,c,l,f){var d=y(e[o],e,c);if("throw"!==d.type){var h=d.arg,w=h.value;return w&&"object"==typeof w&&r.call(w,"__await")?t.resolve(w.__await).then((function(e){n("next",e,l,f)}),(function(e){n("throw",e,l,f)})):t.resolve(w).then((function(e){h.value=e,l(h)}),(function(e){return n("throw",e,l,f)}))}f(d.arg)}var o;this._invoke=function(e,r){function c(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(c,c):c()}}function L(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,L(e,n),"throw"===n.method))return S;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var o=y(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,S;var c=o.arg;return c?c.done?(n[e.resultName]=c.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,S):c:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,S)}function W(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function G(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(W,this),this.reset(!0)}function F(e){if(e){var n=e[c];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:N}}function N(){return{value:t,done:!0}}return T.prototype=I,d(K,"constructor",I),d(I,"constructor",T),T.displayName=d(I,f,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===T||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,I):(e.__proto__=I,d(e,f,"GeneratorFunction")),e.prototype=Object.create(K),e},e.awrap=function(e){return{__await:e}},B(P.prototype),d(P.prototype,l,(function(){return this})),e.AsyncIterator=P,e.async=function(t,n,r,o,c){void 0===c&&(c=Promise);var l=new P(h(t,n,r,o),c);return e.isGeneratorFunction(n)?l:l.next().then((function(e){return e.done?e.value:l.next()}))},B(K),d(K,f,"Generator"),d(K,c,(function(){return this})),d(K,"toString",(function(){return"[object Generator]"})),e.keys=function(object){var e=[];for(var t in object)e.push(t);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in object)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=F,G.prototype={constructor:G,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return l.type="throw",l.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var c=this.tryEntries[i],l=c.completion;if("root"===c.tryLoc)return o("end");if(c.tryLoc<=this.prev){var f=r.call(c,"catchLoc"),d=r.call(c,"finallyLoc");if(f&&d){if(this.prev<c.catchLoc)return o(c.catchLoc,!0);if(this.prev<c.finallyLoc)return o(c.finallyLoc)}else if(f){if(this.prev<c.catchLoc)return o(c.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return o(c.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var c=o?o.completion:{};return c.type=e,c.arg=t,o?(this.method="next",this.next=o.finallyLoc,S):this.complete(c)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),S},finish:function(e){for(var i=this.tryEntries.length-1;i>=0;--i){var t=this.tryEntries[i];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),E(t),S}},catch:function(e){for(var i=this.tryEntries.length-1;i>=0;--i){var t=this.tryEntries[i];if(t.tryLoc===e){var n=t.completion;if("throw"===n.type){var r=n.arg;E(t)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:F(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),S}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}));c.a.config({precision:64,rounding:c.a.ROUND_DOWN,toExpNeg:-64,toExpPos:64});var x=new c.a(10),K=new c.a(2).pow(64),B=K.div(2).sub(1),P=K.div(2).neg(),L=K.sub(1),W=K.pow(63).sub(1),E=W.neg(),G=K.pow(64).sub(1),F=40,N=function(){function e(){}return e.from64Buffer=function(e,t){void 0===t&&(t=0),8!==e.length&&Object(l.default)(!1),Math.abs(t)<F||Object(l.default)(!1);var n=e[7]>=128?new y.a([].concat(e).map((function(i){return("00"+Math.abs(255&~i).toString(16)).slice(-2)})).join(""),16,"le").add(new y.a(1)).neg():new y.a(e,"le");return new c.a(n.toString()).div(x.pow(t))},e.fromU64Buffer=function(e,t){return void 0===t&&(t=0),8!==e.length&&Object(l.default)(!1),Math.abs(t)<F||Object(l.default)(!1),new c.a(new y.a(e,16,"le").toString()).div(x.pow(t))},e.from128Buffer=function(e,t){void 0===t&&(t=0),16!==e.length&&Object(l.default)(!1),Math.abs(t)<F||Object(l.default)(!1);var n=e[15]>=128?new y.a([].concat(e).map((function(i){return("00"+Math.abs(255&~i).toString(16)).slice(-2)})).join(""),16,"le").add(new y.a(1)).neg():new y.a(e,"le");return new c.a(n.toString()).div(x.pow(t))},e.fromU128Buffer=function(e,t){return void 0===t&&(t=0),16!==e.length&&Object(l.default)(!1),Math.abs(t)<F||Object(l.default)(!1),new c.a(new y.a(e,"le").toString()).div(x.pow(t))},e.to64Buffer=function(e,t){void 0===t&&(t=0),Math.abs(t)<F||Object(l.default)(!1),(e=e.mul(x.pow(t)).round()).greaterThanOrEqualTo(P)&&e.lessThanOrEqualTo(B)||Object(l.default)(!1);var n=new y.a(e.toString());if(n.isNeg()){var r=n.add(new y.a(1)).toBuffer("le",8);return r.forEach((function(e,t,input){input[t]=255&~e})),r}return n.toBuffer("le",8)},e.toU64Buffer=function(e,t){return void 0===t&&(t=0),Math.abs(t)<F||Object(l.default)(!1),(e=e.mul(x.pow(t)).round()).greaterThanOrEqualTo(0)&&e.lessThanOrEqualTo(L)||Object(l.default)(!1),new y.a(e.toString()).toBuffer("le",8)},e.to128Buffer=function(e,t){void 0===t&&(t=0),Math.abs(t)<F||Object(l.default)(!1),(e=e.mul(x.pow(t)).round()).greaterThanOrEqualTo(E)&&e.lessThanOrEqualTo(W)||Object(l.default)(!1);var n=new y.a(e.toString());if(n.isNeg()){var r=n.add(new y.a(1)).toBuffer("le",16);return r.forEach((function(e,t,input){input[t]=255&~e})),r}return n.toBuffer("le",16)},e.toU128Buffer=function(e,t){return void 0===t&&(t=0),Math.abs(t)<F||Object(l.default)(!1),(e=e.mul(x.pow(t)).round()).greaterThanOrEqualTo(0)&&e.lessThanOrEqualTo(G)||Object(l.default)(!1),new y.a(e.toString()).toBuffer("le",16)},e}(),U=function(e){void 0===e&&(e="publicKey");var t=Object(f.blob)(32,e),n=function(e){return{decode:e.decode.bind(e),encode:e.encode.bind(e)}}(t),r=n.encode,o=n.decode,c=t;return c.decode=function(e,t){var n=o(e,t);return new d.PublicKey(n)},c.encode=function(e,t,n){var o=e.toBuffer();return r(o,t,n)},c},M=function(e,t){void 0===e&&(e="uint64"),void 0===t&&(t=0);var n=Object(f.blob)(8,e),r=n.decode.bind(n),o=n.encode.bind(n),c=n;return c.decode=function(e,n){var o=r(e,n);return N.fromU64Buffer(o,t)},c.encode=function(e,n,r){var c=N.toU64Buffer(e,t);return o(c,n,r)},c},D=function(e,t){void 0===e&&(e="uint64"),void 0===t&&(t=0);var n=Object(f.blob)(16,e),r=n.decode.bind(n),o=n.encode.bind(n),c=n;return c.decode=function(e,n){var o=r(e,n);return N.from128Buffer(o,t)},c.encode=function(e,n,r){var c=N.to128Buffer(e,t);return o(c,n,r)},c},R=function(e,t){void 0===e&&(e="uint64"),void 0===t&&(t=0);var n=Object(f.blob)(16,e),r=n.decode.bind(n),o=n.encode.bind(n),c=n;return c.decode=function(e,n){var o=r(e,n);return N.fromU128Buffer(o,t)},c.encode=function(e,n,r){var c=N.toU128Buffer(e,t);return o(c,n,r)},c};function _(){if(k.a.config(),e.env.LIVE){switch(e.env.CLUSTER){case"devnet":case"testnet":case"mainnet-beta":return e.env.CLUSTER}throw'Unknown cluster "'+e.env.CLUSTER+'", check the .env file'}}var C,z=_();e.env.RPC_URL||e.env.LIVE,e.env.RPC_URL||e.env.LIVE,e.env.WALLET_URL;function V(e,t){return $.apply(this,arguments)}function $(){return $=T(A.mark((function e(t,n){var r,o,c,l=arguments;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=l.length,o=new Array(r>2?r-2:0),c=2;c<r;c++)o[c-2]=l[c];return e.abrupt("return",Object(d.sendAndConfirmTransaction)(t,n,o,{skipPreflight:!1,commitment:"recent",preflightCommitment:"recent"}));case 2:case"end":return e.stop()}}),e)}))),$.apply(this,arguments)}function H(e,t){return J.apply(this,arguments)}function J(){return(J=T(A.mark((function e(t,n){return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.e.getAssociatedTokenAddress(m.a,m.d,t,n,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e,t,n,r){return m.e.createAssociatedTokenAccountInstruction(m.a,m.d,e,t,n,r)}function Q(e,t){return X.apply(this,arguments)}function X(){return(X=T(A.mark((function e(t,n){var r,o,i,c,f,d,h;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getTokenAccountsByOwner(n,{programId:m.d});case 2:for(r=e.sent,o=[],i=0;i<r.value.length;i++)c=r.value[i],f=c.pubkey,null==(null==(d=c.account)?void 0:d.data)&&Object(l.default)(!1),(h=Z(d)).address=f,o.push(h);return e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){null==(null==e?void 0:e.data)&&Object(l.default)(!1);var t=m.b.decode(null==e?void 0:e.data);return t.mint=new d.PublicKey(t.mint),t.owner=new d.PublicKey(t.owner),t.amount=m.f.fromBuffer(t.amount),0===t.delegateOption?(t.delegate=null,t.delegatedAmount=new m.f(0)):(t.delegate=new d.PublicKey(t.delegate),t.delegatedAmount=m.f.fromBuffer(t.delegatedAmount)),t.isInitialized=0!==t.state,t.isFrozen=2===t.state,1===t.isNativeOption?(t.rentExemptReserve=m.f.fromBuffer(t.isNative),t.isNative=!0):(t.rentExemptReserve=null,t.isNative=!1),0===t.closeAuthorityOption?t.closeAuthority=null:t.closeAuthority=new d.PublicKey(t.closeAuthority),t}!function(e){e[e.Initialize=0]="Initialize",e[e.Swap=1]="Swap",e[e.DepositAllTokenTypes=2]="DepositAllTokenTypes",e[e.WithdrawAllTokenTypes=3]="WithdrawAllTokenTypes",e[e.Claim=4]="Claim",e[e.ManagerClaim=5]="ManagerClaim",e[e.AddUserPosition=6]="AddUserPosition",e[e.UpdateFee=7]="UpdateFee",e[e.SimulateSwap=8]="SimulateSwap"}(C||(C={}));var ee=Object(f.struct)([Object(f.u8)("instruction")]),te=function(e,t,n){var data=r.alloc(ee.span);ee.encode({instruction:C.AddUserPosition},data);var o=[{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:m.d,isSigner:!1,isWritable:!1}];return new d.TransactionInstruction({keys:o,programId:e,data:data})},ne=Object(f.struct)([Object(f.u8)("instruction"),M("positionIndex")]),re=function(e,t,n,o,c,l,f,h,y,w,k,v,S){var data=r.alloc(ne.span);ne.encode({instruction:C.Claim,positionIndex:S},data);var O=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:y,isSigner:!1,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!1},{pubkey:v,isSigner:!1,isWritable:!0},{pubkey:m.d,isSigner:!1,isWritable:!1}];return new d.TransactionInstruction({keys:O,programId:e,data:data})},ie=Object(f.struct)([Object(f.u8)("instruction"),Object(f.u8)("isNewPosition"),R("liquityAmount"),Object(f.s32)("tickLower"),Object(f.s32)("tickUpper"),M("maximumTokenA"),M("maximumTokenB"),M("positionIndex")]),ae=function(e,t,n,o,c,l,f,h,y,w,k,v,S,O,T,I,j,A,x){var data=r.alloc(ie.span);ie.encode({instruction:C.DepositAllTokenTypes,isNewPosition:S,liquityAmount:I,tickLower:O,tickUpper:T,maximumTokenA:j,maximumTokenB:A,positionIndex:x},data);var K=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:w,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!0},{pubkey:v,isSigner:!1,isWritable:!0},{pubkey:m.d,isSigner:!1,isWritable:!1}];return new d.TransactionInstruction({keys:K,programId:e,data:data})},oe=Object(f.struct)([Object(f.u8)("instruction"),Object(f.u8)("nonce"),Object(f.u8)("curveType"),M("fee",12),M("managerFee",12),Object(f.u32)("tickSpace"),R("currentSqrtPrice",12),R("currentLiquity"),R("feeGrowthGlobal0"),R("feeGrowthGlobal1"),R("managerFeeA"),R("managerFeeB")]),ue=function(e,t,n,o,l,f,h,y,w,k,v,S,O,T,I,j){var data=r.alloc(oe.span);oe.encode({instruction:C.Initialize,nonce:v,curveType:S,fee:O,managerFee:T,tickSpace:I,currentSqrtPrice:j,currentLiquity:new c.a(0),feeGrowthGlobal0:new c.a(0),feeGrowthGlobal1:new c.a(0),managerFeeA:new c.a(0),managerFeeB:new c.a(0)},data);var A=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:h,isSigner:!1,isWritable:!1},{pubkey:y,isSigner:!1,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!0},{pubkey:m.d,isSigner:!1,isWritable:!1}];return new d.TransactionInstruction({keys:A,programId:e,data:data})},se=Object(f.struct)([Object(f.u8)("instruction")]),ce=function(e,t,n,o,c,l,f,h){var data=r.alloc(se.span);se.encode({instruction:C.ManagerClaim},data);var y=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:m.d,isSigner:!1,isWritable:!1}];return new d.TransactionInstruction({keys:y,programId:e,data:data})},le=Object(f.struct)([Object(f.u8)("instruction"),M("amountIn"),M("minimumAmountOut")]),pe=function(e,t,n,o,c,l,f,h,y,w,k){var data=r.alloc(le.span);le.encode({instruction:C.Swap,amountIn:w,minimumAmountOut:k},data);var v=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:m.d,isSigner:!1,isWritable:!1}];return new d.TransactionInstruction({keys:v,programId:e,data:data})},fe=Object(f.struct)([Object(f.u8)("instruction"),M("liquityAmount"),M("minimumTokenA"),M("minimumTokenB"),M("positionIndex")]),de=function(e,t,n,o,c,l,f,h,y,w,k,v,S,O,T,I){var data=r.alloc(fe.span);fe.encode({instruction:C.WithdrawAllTokenTypes,liquityAmount:S,minimumTokenA:O,minimumTokenB:T,positionIndex:I},data);var j=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:w,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!0},{pubkey:v,isSigner:!1,isWritable:!0},{pubkey:m.d,isSigner:!1,isWritable:!1}];return new d.TransactionInstruction({keys:j,programId:e,data:data})},he=Object(f.struct)([Object(f.u8)("instruction"),M("amountIn"),Object(f.u8)("direction")]),be=function(e,t,n,o,c){var data=r.alloc(he.span);he.encode({instruction:C.SimulateSwap,amountIn:o,direction:c},data);var l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0}];return new d.TransactionInstruction({keys:l,programId:e,data:data})},ye=84e4,we=Object(f.struct)([Object(f.s32)("tick"),R("tickPrice",12),R("liquityGross"),D("liquityNet"),R("feeGrowthOutsideA",16),R("feeGrowthOutsideB",16)],"tickInfo"),ge=Object(f.struct)([Object(f.u8)("swapVersion"),U("tokenSwapKey"),Object(f.u8)("accountType"),Object(f.s32)("len"),Object(f.blob)(839962,"dataFlat")],"ticksAccount"),ke=function(e){return e.data.length===ye},me=function(e,t){if(ke(t)){var n=r.from(t.data),o=ge.decode(n),c=o.swapVersion,l=o.tokenSwapKey,d=o.accountType,h=o.len,y=o.dataFlat,w=h*we.span,k=y.slice(0,w);return{pubkey:e,info:t,data:{swapVersion:c,tokenSwapKey:l,accountType:d,len:h,ticks:Object(f.seq)(we,h).decode(k)}}}},ve=36e4,Se=Object(f.struct)([U("nftTokenId"),Object(f.s32)("lowerTick"),Object(f.s32)("upperTick"),R("liquity"),R("feeGrowthInsideALast",16),R("feeGrowthInsideBLast",16),R("tokenAFee",16),R("tokenBFee",16)],"position"),Oe=Object(f.struct)([Object(f.u8)("swapVersion"),U("tokenSwapKey"),Object(f.u8)("accountType"),Object(f.s32)("len"),Object(f.blob)(359962,"dataFlat")],"positionsAccount"),Te=Math.floor(359962/Se.span),Ie=function(e){return e.data.length===ve},je=function(e,t){if(Ie(t)){var n=r.from(t.data),o=Oe.decode(n),c=o.swapVersion,l=o.tokenSwapKey,d=o.accountType,h=o.len,y=o.dataFlat,w=h*Se.span,k=y.slice(0,w);return{pubkey:e,info:t,data:{swapVersion:c,tokenSwapKey:l,accountType:d,len:h,positions:Object(f.seq)(Se,h).decode(k)}}}},Ae=Object(f.struct)([U("tokenSwapKey"),Object(f.u8)("accountType"),Object(f.u8)("version"),Object(f.u8)("isInitialized"),Object(f.u8)("nonce"),U("tokenProgramId"),U("manager"),U("managerTokenA"),U("managerTokenB"),U("swapTokenA"),U("swapTokenB"),U("tokenAMint"),U("tokenBMint"),U("ticksKey"),U("positionsKey"),Object(f.u8)("curveType"),M("fee",12),M("managerFee",12),Object(f.u32)("tickSpace"),R("currentSqrtPrice",12),R("currentLiquity"),R("feeGrowthGlobal0",16),R("feeGrowthGlobal1",16),R("managerFeeA"),R("managerFeeB")],"tokenSwapAccount"),xe=Ae.span,Ke=function(e){return e.data.length===xe},Be=function(e,t){if(Ke(t)){var n=r.from(t.data);return{pubkey:e,info:t,data:Ae.decode(n)}}};c.a.config({precision:64,rounding:c.a.ROUND_HALF_DOWN,toExpNeg:-64,toExpPos:64});var Pe=443632,Le=-443632,qe=new c.a("1.0001"),We=qe.pow(Pe),Ee=qe.pow(Le),Ge=qe.pow(221816),Fe=qe.pow(-221816);function Ne(e){return e.lessThan(Ge)||Object(l.default)(!1),e.greaterThan(Fe)||Object(l.default)(!1),e.pow(2).log(qe).toDP(0,c.a.ROUND_HALF_UP).toNumber()}function Ue(e){return e>=Le&&e<=Pe||Object(l.default)(!1),qe.pow(e/2)}function Me(e){return e>=Le&&e<=Pe||Object(l.default)(!1),qe.pow(e)}function De(e,t){t>0&&t%1==0||Object(l.default)(!1),e.lessThan(We)||Object(l.default)(!1),e.greaterThan(Ee)||Object(l.default)(!1);var n=function(e){return e.lessThan(We)||Object(l.default)(!1),e.greaterThan(Ee)||Object(l.default)(!1),e.log(qe).toDP(0,c.a.ROUND_HALF_UP).toNumber()}(e),r=(n-Le)%t;return r>t/2?n-r+t:n-r}function Re(e,t,n){var r=new c.a(1);return n.mul(r.div(e).sub(r.div(t)))}function _e(e,t,n){return n.mul(t.sub(e))}function Ce(e,t,n,r){var o=_e(e,t,n),c=n.div(r.add(n.div(t))),l=_e(e,c,n);return{amountOut:o.sub(l),afterSqrtPrice:c}}function ze(e,t,n,r){var o=Re(e,t,n),c=r.div(n).add(e),l=Re(c,t,n);return{amountOut:o.sub(l),afterSqrtPrice:c}}function Ve(e,t,n,r,o){e<t||Object(l.default)(!1);var f=Ue(e),d=Ue(t);r.greaterThanOrEqualTo(f)&&r.lessThanOrEqualTo(d)||Object(l.default)(!1);var h=new c.a(1);if(0===o){var y=n.div(h.div(r).sub(h.div(d)));return{desiredAmountDst:y.mul(r.sub(f)),deltaLiquity:y}}var w=n.div(r.sub(f));return{desiredAmountDst:w.mul(h.div(r).sub(h.div(d))),deltaLiquity:w}}function $e(e,t,n){e<t||Object(l.default)(!1);var r=Ue(e),o=Ue(t),f=new c.a(1);return n.div(f.div(r).sub(f.div(o)))}function He(e,t,n){e<t||Object(l.default)(!1);var r=Ue(e),o=Ue(t);return n.div(o.sub(r))}var Je=new d.PublicKey("11111111111111111111111111111111"),Ye=function(){function e(e,t,n,r){this.programId=Je,this.tokenSwapKey=Je,this.authority=Je,this.isLoaded=!1,this.currentTick=0,this.tokenSwapInfo={tokenSwapKey:Je,accountType:0,version:0,isInitialized:0,nonce:0,tokenProgramId:m.d,manager:Je,managerTokenA:Je,managerTokenB:Je,swapTokenA:Je,swapTokenB:Je,tokenAMint:Je,tokenBMint:Je,ticksKey:Je,positionsKey:Je,curveType:0,fee:new c.a(0),managerFee:new c.a(0),tickSpace:0,currentSqrtPrice:new c.a(0),currentLiquity:new c.a(0),feeGrowthGlobal0:new c.a(0),feeGrowthGlobal1:new c.a(0),managerFeeA:new c.a(0),managerFeeB:new c.a(0)},this.ticks=[],this.conn=e,this.tokenSwapKey=n,this.programId=t,this.payer=r,this.positions=new Map,this.positionsKeys=new Map}var t=e.prototype;return t.setDefaultPayer=function(e){this.payer=e},t.load=function(){var e=T(A.mark((function e(){var t,n,r,o=this;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={encoding:"base64",filters:[{memcmp:{offset:1,bytes:this.tokenSwapKey.toBase58()}}]},e.next=3,this.conn.getProgramAccounts(this.programId,t);case 3:if(e.sent.map((function(e){if(Ke(e.account)){var t=Be(e.pubkey,e.account);void 0===(null==t?void 0:t.data)&&Object(l.default)(!1),o.tokenSwapInfo=t.data}else if(ke(e.account)){var n=me(e.pubkey,e.account);void 0===(null==n?void 0:n.data)&&Object(l.default)(!1),o.ticks=n.data.ticks}else if(Ie(e.account)){var r=je(e.pubkey,e.account);void 0===(null==r?void 0:r.data)&&Object(l.default)(!1),o.positionsKeys.set(e.pubkey,r.data.positions.length);for(var i=0;i<r.data.positions.length;i++){var p=r.data.positions[i];o.positions.set(p.nftTokenId.toBase58(),{positionsKey:e.pubkey,index:new c.a(i),positionId:p.nftTokenId,lowerTick:p.lowerTick,upperTick:p.upperTick,liquity:p.liquity,feeGrowthInsideALast:p.feeGrowthInsideALast,feeGrowthInsideBLast:p.feeGrowthInsideBLast,tokenAFee:p.tokenAFee,tokenBFee:p.tokenBFee})}}else console.log("the account:%s length:%d unkown",e.pubkey.toString(),e.account.data.length)})),this.authority.toString()!==Je.toString()){e.next=11;break}return e.next=8,d.PublicKey.findProgramAddress([this.tokenSwapKey.toBuffer()],this.programId);case 8:n=e.sent,r=n[0],this.authority=r;case 11:return this.isLoaded=!0,this.currentTick=Ne(this.tokenSwapInfo.currentSqrtPrice),e.abrupt("return",this);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.createTokenSwap=function(){var t=T(A.mark((function t(n,r,o,c,l,f,h,y,w,k,v){var S,O,T,I,j,x,K,B,P,L,W,E,G,F,N,U,M,D;return A.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===v&&(v=!1),S=d.Keypair.generate(),O=d.Keypair.generate(),T=d.Keypair.generate(),t.next=6,d.PublicKey.findProgramAddress([S.publicKey.toBuffer()],r);case 6:return I=t.sent,j=I[0],x=I[1],t.next=11,n.getMinimumBalanceForRentExemption(ye);case 11:return K=t.sent,t.next=14,n.getMinimumBalanceForRentExemption(ve);case 14:return B=t.sent,t.next=17,n.getMinimumBalanceForRentExemption(xe);case 17:return P=t.sent,L=(new d.Transaction).add(d.SystemProgram.createAccount({fromPubkey:k.publicKey,newAccountPubkey:S.publicKey,lamports:P,space:xe,programId:r}),d.SystemProgram.createAccount({fromPubkey:k.publicKey,newAccountPubkey:O.publicKey,lamports:K,space:ye,programId:r}),d.SystemProgram.createAccount({fromPubkey:k.publicKey,newAccountPubkey:T.publicKey,lamports:B,space:ve,programId:r})),t.next=21,H(o,j);case 21:return W=t.sent,t.next=24,H(c,j);case 24:return E=t.sent,L.add(Y(o,W,j,k.publicKey),Y(c,E,j,k.publicKey)),G=w.sqrt(),F=new m.e(n,o,m.d,k),N=new m.e(n,c,m.d,k),t.next=31,F.getOrCreateAssociatedAccountInfo(l);case 31:return U=t.sent,t.next=34,N.getOrCreateAssociatedAccountInfo(l);case 34:return M=t.sent,0,L.add(ue(r,S.publicKey,j,l,U.address,M.address,W,E,O.publicKey,T.publicKey,x,0,f,h,y,G)),t.next=39,V(n,L,k,S,O,T);case 39:return D=t.sent,v&&console.log(D),t.next=43,new e(n,r,S.publicKey,k).load();case 43:return t.abrupt("return",t.sent);case 44:case"end":return t.stop()}}),t)})));return function(e,n,r,o,c,l,f,d,h,y,w){return t.apply(this,arguments)}}(),t.mintPosition=function(){var e=T(A.mark((function e(t,n,r,o,f,h,y,w,k){var v,S,O,T,I;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===k&&(k=null),!this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return r<o||Object(l.default)(!1),null==(k=null!=k?k:this.payer)&&Object(l.default)(!1),v=d.Keypair.generate(),e.next=10,H(v.publicKey,k.publicKey);case 10:return S=e.sent,e.next=13,m.e.getMinBalanceRentForExemptAccount(this.conn);case 13:return O=e.sent,null==(T=this.choosePosition())&&Object(l.default)(!1),(I=new d.Transaction).add(d.SystemProgram.createAccount({fromPubkey:k.publicKey,newAccountPubkey:v.publicKey,lamports:O,space:m.c.span,programId:m.d}),m.e.createInitMintInstruction(m.d,v.publicKey,0,this.authority,null),Y(v.publicKey,S,k.publicKey,k.publicKey)),I.add(ae(this.programId,this.tokenSwapKey,this.authority,w.publicKey,t,n,this.tokenSwapInfo.swapTokenA,this.tokenSwapInfo.swapTokenB,v.publicKey,S,this.tokenSwapInfo.ticksKey,T,0,r,o,f,h,y,new c.a(0))),e.next=21,V(this.conn,I,k,w,v);case 21:return e.abrupt("return",e.sent);case 22:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,c,l,f,d,h){return e.apply(this,arguments)}}(),t.increaseLiquity=function(){var e=T(A.mark((function e(t,n,r,o,c,f,h){var y,w,k,v;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===h&&(h=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null==(y=this.getPositionInfo(t))&&Object(l.default)(!1),null===(h=null!=h?h:this.payer)&&Object(l.default)(!1),w=new m.e(this.conn,t,m.d,h),e.t0=w,e.next=12,H(w.publicKey,h.publicKey);case 12:return e.t1=e.sent,e.next=15,e.t0.getAccountInfo.call(e.t0,e.t1);case 15:return 1!==(k=e.sent).amount.toNumber()&&Object(l.default)(!1),(v=new d.Transaction).add(ae(this.programId,this.tokenSwapKey,this.authority,h.publicKey,n,r,this.tokenSwapInfo.swapTokenA,this.tokenSwapInfo.swapTokenB,t,k.address,this.tokenSwapInfo.ticksKey,y.positionsKey,1,y.lowerTick,y.upperTick,o,c,f,y.index)),e.next=21,V(this.conn,v,h);case 21:return e.abrupt("return",e.sent);case 22:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,c,l,f){return e.apply(this,arguments)}}(),t.decreaseLiquity=function(){var e=T(A.mark((function e(t,n,r,o,c,f,h){var y,w,k,v;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===h&&(h=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null==(y=this.getPositionInfo(t))&&Object(l.default)(!1),null===(h=null!=h?h:this.payer)&&Object(l.default)(!1),w=new m.e(this.conn,t,m.d,h),e.t0=w,e.next=12,H(w.publicKey,h.publicKey);case 12:return e.t1=e.sent,e.next=15,e.t0.getAccountInfo.call(e.t0,e.t1);case 15:return 1!==(k=e.sent).amount.toNumber()&&Object(l.default)(!1),v=(new d.Transaction).add(de(this.programId,this.tokenSwapKey,this.authority,h.publicKey,this.tokenSwapInfo.swapTokenA,this.tokenSwapInfo.swapTokenB,n,r,t,k.address,this.tokenSwapInfo.ticksKey,y.positionsKey,o,c,f,y.index)),e.next=20,V(this.conn,v,h);case 20:return e.abrupt("return",e.sent);case 21:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,c,l,f){return e.apply(this,arguments)}}(),t.swap=function(){var e=T(A.mark((function e(t,n,r,o,c,f,h){var y,w,k,m;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===h&&(h=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null===(h=null!=h?h:this.payer)&&Object(l.default)(!1),y=1===r?{swapSrc:this.tokenSwapInfo.swapTokenA,swapDst:this.tokenSwapInfo.swapTokenB}:{swapSrc:this.tokenSwapInfo.swapTokenB,swapDst:this.tokenSwapInfo.swapTokenA},w=y.swapSrc,k=y.swapDst,m=(new d.Transaction).add(pe(this.programId,this.tokenSwapKey,this.authority,f.publicKey,t,n,w,k,this.tokenSwapInfo.ticksKey,o,c)),e.next=10,V(this.conn,m,h,f);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,c,l,f){return e.apply(this,arguments)}}(),t.simulateSwap=function(){var e=T(A.mark((function e(t,n){var r,o,c,data,l,f,h,y,i,w;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isLoaded){e.next=3;break}return e.next=3,this.load();case 3:return r=new d.Account([28,238,111,197,225,201,97,110,4,222,88,46,199,135,147,59,80,133,221,255,126,100,254,187,140,98,43,86,237,193,90,197,146,11,118,141,57,183,100,175,139,250,94,13,213,142,144,126,171,141,44,183,237,37,230,234,62,146,242,27,192,67,235,42]),o=(new d.Transaction).add(be(this.programId,this.tokenSwapKey,this.tokenSwapInfo.ticksKey,t,n)),e.next=7,this.conn.getRecentBlockhash();case 7:return c=e.sent,o.recentBlockhash=c.blockhash,o.feePayer=r.publicKey,data=o.serialize({requireAllSignatures:!1,verifySignatures:!1}).toString("base64"),l={jsonrpc:"2.0",id:1,method:"simulateTransaction",params:[data,{replaceRecentBlockhash:!0,encoding:"base64"}]},f=0,e.prev=13,e.next=16,S.a.post("https://mercurial.rpcpool.com",l);case 16:h=e.sent,y=h.data.result.value.logs,i=0;case 19:if(!(i<y.length)){e.next=27;break}if(!(y[i].indexOf("SimulateSwapAmountOut")>-1)){e.next=24;break}return w=y[i].split(":"),f=w[w.length-1],e.abrupt("break",27);case 24:i++,e.next=19;break;case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(13),S.a.isAxiosError(e.t0)?console.log("simulateSwap###error##1111####",e.t0):console.log("simulateSwap###error###2222####",e.t0);case 32:return e.abrupt("return",f);case 33:case"end":return e.stop()}}),e,this,[[13,29]])})));return function(t,n){return e.apply(this,arguments)}}(),t.preSwapAV2=function(){var e=T(A.mark((function e(t,n,o,c,f){var h,y,a;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isLoaded){e.next=3;break}return e.next=3,this.load();case 3:return h=(new d.Transaction).add(pe(this.programId,this.tokenSwapKey,this.authority,o.publicKey,c,f,this.tokenSwapInfo.swapTokenA,this.tokenSwapInfo.swapTokenB,this.tokenSwapInfo.ticksKey,t,n)),e.next=6,this.conn.simulateTransaction(h,[],[c,f]);case 6:y=e.sent,console.log(y),null==y.value.accounts&&Object(l.default)(!1),console.log(y.value.accounts[0]),console.log(y.value.accounts[1]),data=r.from(y.value.accounts[0].data[0],"base64"),w=void 0,(w=m.b.decode(data)).mint=new d.PublicKey(w.mint),w.owner=new d.PublicKey(w.owner),w.amount=m.f.fromBuffer(w.amount),0===w.delegateOption?(w.delegate=null,w.delegatedAmount=new m.f(0)):(w.delegate=new d.PublicKey(w.delegate),w.delegatedAmount=m.f.fromBuffer(w.delegatedAmount)),w.isInitialized=0!==w.state,w.isFrozen=2===w.state,1===w.isNativeOption?(w.rentExemptReserve=m.f.fromBuffer(w.isNative),w.isNative=!0):(w.rentExemptReserve=null,w.isNative=!1),0===w.closeAuthorityOption?w.closeAuthority=null:w.closeAuthority=new d.PublicKey(w.closeAuthority),a=w,console.log(a.amount.toString());case 13:case"end":return e.stop()}var data,w}),e,this)})));return function(t,n,r,o,c){return e.apply(this,arguments)}}(),t.collect=function(){var e=T(A.mark((function e(t,n,r,o){var c,f,h,y;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===o&&(o=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null==(c=this.getPositionInfo(t))&&Object(l.default)(!1),null===(o=null!=o?o:this.payer)&&Object(l.default)(!1),f=new m.e(this.conn,t,m.d,o),e.t0=f,e.next=12,H(f.publicKey,o.publicKey);case 12:return e.t1=e.sent,e.next=15,e.t0.getAccountInfo.call(e.t0,e.t1);case 15:return 1!==(h=e.sent).amount.toNumber()&&Object(l.default)(!1),y=(new d.Transaction).add(re(this.programId,this.tokenSwapKey,this.authority,o.publicKey,this.tokenSwapInfo.swapTokenB,this.tokenSwapInfo.swapTokenB,n,r,t,h.address,this.tokenSwapInfo.ticksKey,c.positionsKey,c.index)),e.next=20,V(this.conn,y,o);case 20:return e.abrupt("return",e.sent);case 21:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o){return e.apply(this,arguments)}}(),t.managerCollect=function(){var e=T(A.mark((function e(t,n,r){var o;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null===(r=null!=r?r:this.payer)&&Object(l.default)(!1),o=(new d.Transaction).add(ce(this.programId,this.tokenSwapKey,this.authority,r.publicKey,this.tokenSwapInfo.swapTokenA,this.tokenSwapInfo.swapTokenB,t,n)),e.next=9,V(this.conn,o,r);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.addPositionsAccount=function(){var e=T(A.mark((function e(t){var n,r,o;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null===(t=null!=t?t:this.payer)&&Object(l.default)(!1),n=d.Keypair.generate(),e.next=9,this.conn.getMinimumBalanceForRentExemption(ve);case 9:return r=e.sent,o=(new d.Transaction).add(d.SystemProgram.createAccount({fromPubkey:t.publicKey,newAccountPubkey:n.publicKey,lamports:r,space:ve,programId:this.programId}),te(this.programId,this.authority,n.publicKey)),e.next=13,V(this.conn,o,t,n);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.approve=function(){var e=T(A.mark((function e(t,n,r,o,c){var f;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===c&&(c=null),null===(c=null!=c?c:this.payer)&&Object(l.default)(!1),f=new m.e(this.conn,n,m.d,c),e.next=6,f.approve(t,o.publicKey,c,[],r.toNumber());case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,c){return e.apply(this,arguments)}}(),t.getUserPositions=function(){var e=T(A.mark((function e(t){var n,r,o,i,c;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=void 0),this.isLoaded||Object(l.default)(!1),void 0===(t=null!=t?t:null==(n=this.payer)?void 0:n.publicKey)&&Object(l.default)(!1),e.next=6,Q(this.conn,t);case 6:for(r=e.sent,o=[],i=0;i<r.length;i++)void 0!==(c=this.positions.get(r[i].mint.toBase58()))&&o.push(c);return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.calculateLiquityByTokenA=function(e,t,n){if(this.isLoaded||Object(l.default)(!1),this.currentTick<=t||Object(l.default)(!1),this.currentTick<e)return{desiredAmountB:new c.a(0),liquity:$e(e,t,n)};var r=Ve(e,t,n,this.tokenSwapInfo.currentSqrtPrice,0);return{desiredAmountB:r.desiredAmountDst,liquity:r.deltaLiquity}},t.calculateLiquityByTokenB=function(e,t,n){if(this.isLoaded||Object(l.default)(!1),this.currentTick>=e||Object(l.default)(!1),this.currentTick<t)return{desiredAmountA:new c.a(0),liquity:He(e,t,n)};var r=Ve(e,t,n,this.tokenSwapInfo.currentSqrtPrice,1);return{desiredAmountA:r.desiredAmountDst,liquity:r.deltaLiquity}},t.calculatePositionValue=function(e){this.isLoaded||Object(l.default)(!1);var t=this.getPositionInfo(e);void 0===t&&Object(l.default)(!1);var n,r,o,f,d,h,y=(n=t.lowerTick,r=t.upperTick,o=t.liquity,f=this.tokenSwapInfo.currentSqrtPrice,d=Ue(n),h=Ue(r),f.lessThan(d)?{amountA:o.div(d).sub(o.div(h)),amountB:new c.a(0)}:f.greaterThan(h)?{amountA:new c.a(0),amountB:o.mul(h).sub(o.mul(d))}:{amountA:o.div(f).sub(o.div(h)),amountB:o.mul(f).sub(o.mul(d))}),w=y.amountA,k=y.amountB;return{liquity:t.liquity,amountA:w,amountB:k}},t.preCollect=function(e){this.isLoaded||Object(l.default)(!1);var t=this.getPositionInfo(e);void 0===t&&Object(l.default)(!1);for(var n=null,r=null,i=0;i<=this.ticks.length;i++)this.ticks[i].tick==t.lowerTick&&(n=this.ticks[i]),this.ticks[i].tick==t.upperTick&&(r=this.ticks[i]);return null===n&&Object(l.default)(!1),null===r&&Object(l.default)(!1),this.currentTick<n.tick?{amountA:n.feeGrowthOutside0.sub(r.feeGrowthOutside0).mul(t.liquity).sub(t.feeGrowthInsideALast),amountB:n.feeGrowthOutside1.sub(r.feeGrowthOutside1).mul(t.liquity).sub(t.feeGrowthInsideBLast)}:this.currentTick>r.tick?{amountA:r.feeGrowthOutside0.sub(n.feeGrowthOutside0).mul(t.liquity).sub(t.feeGrowthInsideBLast),amountB:r.feeGrowthOutside1.sub(n.feeGrowthOutside1).mul(t.liquity).sub(t.feeGrowthInsideBLast)}:{amountA:this.tokenSwapInfo.feeGrowthGlobal0.sub(r.feeGrowthOutside0).sub(n.feeGrowthOutside0).mul(t.liquity).sub(t.feeGrowthInsideALast),amountB:this.tokenSwapInfo.feeGrowthGlobal1.sub(r.feeGrowthOutside1).sub(n.feeGrowthOutside1).mul(t.liquity).sub(t.feeGrowthInsideBLast)}},t.preSwapA=function(e){return this.isLoaded||Object(l.default)(!1),function(e,t,n,r,o){o.greaterThan(new c.a(0))||Object(l.default)(!1),r.greaterThanOrEqualTo(new c.a(0))||Object(l.default)(!1),e.length>0||Object(l.default)(!1);var f=Ne(t);f>e[0].tick||Object(l.default)(!1);for(var d=r,h=new c.a(0),y=n.div(new c.a(1).sub(n)).add(new c.a(1)),w=o.div(y),k=new c.a(0),m=t,i=e.length-1;i>=0;i--)if(d.equals(new c.a(0)))f=e[i].tick,d=d.sub(e[i].liquityNet),m=Me(f);else if(!(f<=e[i].tick)){var v=Ue(e[i].tick),S=Re(v,m,d);if(S.greaterThanOrEqualTo(w)){var O=Ce(v,m,d,w),T=O.amountOut,I=O.afterSqrtPrice;return console.log("liquity:%s price:[%s - %s] tick[%d - %d] out:%s",d.toString(),v.toDP(20).toString(),m.toDP(20).toString(),e[i].tick,f,k.toDP(8).toString()),k=k.add(w.mul(y)),{amountOut:h.add(T),amountUsed:k,afterPrice:I.pow(2),afterLiquity:d}}w=w.sub(S),k=k.add(S.mul(y)),h=h.add(_e(v,m,d)),d=d.sub(e[i].liquityNet),m=Ue(f=e[i].tick)}return{amountOut:h,amountUsed:k,afterPrice:Me(f),afterLiquity:d}}(this.ticks,this.tokenSwapInfo.currentSqrtPrice,this.tokenSwapInfo.fee,this.tokenSwapInfo.currentLiquity,e)},t.preSwapB=function(e){return this.isLoaded||Object(l.default)(!1),function(e,t,n,r,o){o.greaterThan(new c.a(0))||Object(l.default)(!1),r.greaterThanOrEqualTo(new c.a(0))||Object(l.default)(!1),e.length>0||Object(l.default)(!1);var f=Ne(t);f<e[e.length-1].tick||Object(l.default)(!1);for(var d=r,h=new c.a(0),y=n.div(new c.a(1).sub(n)).add(new c.a(1)),w=o.div(y),k=new c.a(0),m=t,i=0;i<e.length;i++)if(d.equals(new c.a(0)))f=e[i].tick,d=d.add(e[i].liquityNet),m=Ue(f);else if(!(f>=e[i].tick)){var v=Ue(e[i].tick),S=_e(m,v,d);if(S.greaterThanOrEqualTo(w)){var O=ze(m,v,d,w),T=O.amountOut,I=O.afterSqrtPrice;return console.log("liquity:%s price:[%s - %s] tick[%d - %d] out:%s",d.toString(),m.toDP(20).toString(),v.toDP(20).toString(),f,e[i].tick,k.toDP(8).toString()),k=k.add(w.mul(y)),{amountOut:h.add(T),amountUsed:k,afterPrice:I.pow(2),afterLiquity:d}}w=w.sub(S),k=k.add(S.mul(y)),h=h.add(Re(m,v,d)),d=d.add(e[i].liquityNet),m=Ue(f=e[i].tick)}return{amountOut:h,amountUsed:k,afterPrice:Me(f),afterLiquity:d}}(this.ticks,this.tokenSwapInfo.currentSqrtPrice,this.tokenSwapInfo.fee,this.tokenSwapInfo.currentLiquity,e)},t.getNearestTickByPrice=function(e){return this.isLoaded||Object(l.default)(!1),De(e,this.tokenSwapInfo.tickSpace)},t.getPositionInfo=function(e){return this.isLoaded||Object(l.default)(!1),this.positions.get(e.toBase58())},t.choosePosition=function(){this.isLoaded||Object(l.default)(!1);for(var e,t=j(this.positionsKeys);!(e=t()).done;){var n=e.value,r=n[0];if(n[1]<Te)return r}return null},t.log=function(){var e=null!==this.payer?this.payer.publicKey.toBase58():"null";console.log(JSON.stringify({programId:this.programId.toString(),tokenSwapKey:this.tokenSwapKey.toString(),payer:e,authority:this.authority.toString(),currentTick:this.currentTick,currentPrice:this.tokenSwapInfo.currentSqrtPrice.pow(2).toString(),tokenSwapInfo:{accountType:this.tokenSwapInfo.accountType,version:this.tokenSwapInfo.version,isInitialized:this.tokenSwapInfo.isInitialized,nonce:this.tokenSwapInfo.nonce,manager:this.tokenSwapInfo.manager.toString(),managerTokenA:this.tokenSwapInfo.managerTokenA.toString(),managerTokenB:this.tokenSwapInfo.managerTokenB.toString(),swapTokenA:this.tokenSwapInfo.swapTokenA.toString(),swapTokenB:this.tokenSwapInfo.swapTokenB.toString(),tokenAMint:this.tokenSwapInfo.tokenAMint.toString(),tokenBMint:this.tokenSwapInfo.tokenBMint.toString(),ticksKey:this.tokenSwapInfo.ticksKey.toString(),positionsKey:this.tokenSwapInfo.positionsKey.toString(),curveType:this.tokenSwapInfo.curveType,fee:this.tokenSwapInfo.fee,managerFee:this.tokenSwapInfo.managerFee,tickSpace:this.tokenSwapInfo.tickSpace,currentSqrtPrice:this.tokenSwapInfo.currentSqrtPrice,currentLiquity:this.tokenSwapInfo.currentLiquity,feeGrowthGlobal0:this.tokenSwapInfo.feeGrowthGlobal0,feeGrowthGlobal1:this.tokenSwapInfo.feeGrowthGlobal1,managerFeeA:this.tokenSwapInfo.managerFeeA,managerFeeB:this.tokenSwapInfo.managerFeeB},positions:Object.fromEntries(this.positions),positionsKeys:Object.fromEntries(this.positionsKeys),ticks:this.ticks},null,4))},e}()}).call(this,n(104),n(5).Buffer)},1969:function(e,t,n){(function(t){const r=n(391),path=n(813),o=n(812);function c(e){console.log(`[dotenv][DEBUG] ${e}`)}const l=/^\s*([\w.-]+)\s*=\s*(.*)?\s*$/,f=/\\n/g,d=/\r\n|\n|\r/;function h(e,t){const n=Boolean(t&&t.debug),r={};return e.toString().split(d).forEach((function(line,e){const t=line.match(l);if(null!=t){const e=t[1];let n=t[2]||"";const o=n.length-1,c='"'===n[0]&&'"'===n[o];"'"===n[0]&&"'"===n[o]||c?(n=n.substring(1,o),c&&(n=n.replace(f,"\n"))):n=n.trim(),r[e]=n}else n&&c(`did not match key and value when parsing line ${e+1}: ${line}`)})),r}e.exports.config=function(e){let n=path.resolve(t.cwd(),".env"),l="utf8",f=!1;var d;e&&(null!=e.path&&(n="~"===(d=e.path)[0]?path.join(o.homedir(),d.slice(1)):d),null!=e.encoding&&(l=e.encoding),null!=e.debug&&(f=!0));try{const e=h(r.readFileSync(n,{encoding:l}),{debug:f});return Object.keys(e).forEach((function(n){Object.prototype.hasOwnProperty.call(t.env,n)?f&&c(`"${n}" is already defined in \`process.env\` and will not be overwritten`):t.env[n]=e[n]})),{parsed:e}}catch(e){return{error:e}}},e.exports.parse=h}).call(this,n(104))},2056:function(e,t,n){"use strict";var r=n(231),o=n(517),c=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,l=/^\w*$/;var f=function(e,object){if(Object(r.a)(e))return!1;var t=typeof e;return!("number"!=t&&"symbol"!=t&&"boolean"!=t&&null!=e&&!Object(o.a)(e))||(l.test(e)||!c.test(e)||null!=object&&e in Object(object))},d=n(521);function h(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],c=n.cache;if(c.has(o))return c.get(o);var l=e.apply(this,r);return n.cache=c.set(o,l)||c,l};return n.cache=new(h.Cache||d.a),n}h.Cache=d.a;var y=h;var w=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,k=/\\(\\)?/g,m=function(e){var t=y(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(w,(function(e,n,r,o){t.push(r?o.replace(k,"$1"):n||e)})),t})),v=n(171);var S=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o},O=v.a?v.a.prototype:void 0,T=O?O.toString:void 0;var I=function e(t){if("string"==typeof t)return t;if(Object(r.a)(t))return S(t,e)+"";if(Object(o.a)(t))return T?T.call(t):"";var n=t+"";return"0"==n&&1/t==-Infinity?"-0":n};var j=function(e){return null==e?"":I(e)};var A=function(e,object){return Object(r.a)(e)?e:f(e,object)?[e]:m(j(e))};var x=function(e){if("string"==typeof e||Object(o.a)(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t};var K=function(object,path){for(var e=0,t=(path=A(path,object)).length;null!=object&&e<t;)object=object[x(path[e++])];return e&&e==t?object:void 0};t.a=function(object,path,e){var t=null==object?void 0:K(object,path);return void 0===t?e:t}}}]);