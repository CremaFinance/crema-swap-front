(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{3373:function(e,t,n){"use strict";var r=n(25),o=n(12),c=n(10),l=(n(3265),n(3266)),d=n.n(l),m=(n(3279),n(3280)),h=n.n(m),f=(n(770),n(523)),w=n.n(f),k=(n(34),n(28),n(70),n(109),n(135),n(58),n(59),n(46),n(134),n(62),n(280),n(69)),y=n(768),v=n(299),S=n(106),O=n(36),x=n(1),j=n(11),P=n(30),D=n(483),R=n(26),$=n(108),T=n(452),_=n(199),C=n(315),M=n(305),K=function(e,t,n,r){return new(n||(n=Promise))((function(o,c){function l(e){try{m(r.next(e))}catch(e){c(e)}}function d(e){try{m(r.throw(e))}catch(e){c(e)}}function m(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,d)}m((r=r.apply(e,t||[])).next())}))};k.default.use(w.a),t.a=k.default.extend({components:{Button:w.a,Tooltip:h.a,Spin:d.a},props:{searchKey:{type:String,default:""},currentType:{type:String,default:""},tvlData:{type:Object,default:function(){return{}}}},data:function(){return{stakeTitle:"Stake",showStake:!1,isShowTableTr:-1,changeNFT:!1,dataNFT:!0,tableData:[{NFTID:"2",Liquidity:"$ 856.89",PriceRange:"1 - 1.002",isStaked:"Stake"},{NFTID:"1",Liquidity:"$ 1,395.27",PriceRange:"1 - 1.002",isStaked:"Unstake"}],nftData:[],isEewardRangeTab:-1,dataOriginList:[],dataList:[],isStaking:!1,isUnStaking:!1,isClaiming:!1,isDisabled:!1,currentPosition:null,currentPool:null,aprAndTvlObj:{},isOpenArr:{},rewardTokenObj:{CRMaDAzKCWYbhUfsKYA8448vaA1qUzCETd7gNBDzQ1ks:{name:"CRM",decimal:9},rmdfxskErRXRvMjiCoSiBQNp1wWeBQe19YeHZGBe3jD:{name:"MNDE",decimal:"9"},RLDo72wLsjrzRWdkz3DcgsQj4p2HeZKioydUyjyatYi:{name:"LDO",decimal:"8"},CHdG3BVWrADKT4Hh6jcLpvfQfAiSmnLLqx7X8q5cnR2D:{name:"HDG",decimal:"9"}},stakeSuccess:!1,stakeFailed:!1,rewardRange:{DM3hoNvAHSZxqAT1q8NYZJfC5NU3PY3V96nqQwSVYiTb:{name:"USDT-USDC",rewardRange:"0.999 - 1.0005"},DqoE4gtukSEzFDdZ4ymeay1tBS6h8Z7BYCSmFWHyuDgP:{name:"mSOL-SOL",rewardRange:"1.04 - 1.08"},"8x5Rjz61rh4N5CdFHGQQNGK2vAND9Lt8SXCBshye8kU4":{name:"stSOL-SOL",rewardRange:"1.03 - 1.07"},Fg8NYsi6zv7Yhtww7mQqQ8wwpAGQDUxMTccKtxp1PicM:{name:"USDH-USDC",rewardRange:"0.998 - 1.008"},"8a5StzsVKvf9Lwv7CPN82Bcbnaws8gUiGp5LzVSV2QRY":{name:"USH-USDC",rewardRange:"0.99 - 1.05"}}}},computed:Object.assign({},Object(v.e)(["wallet","transaction","url","farming","liquidity","farmingv2"])),watch:{"farmingv2.farmingList":{handler:"watchFarmingV2List",immediate:!0},tableData:{handler:function(e,t){e[0]?this.changeNFT=!1:this.changeNFT=!0},deep:!0},"liquidity.poolsObj":{handler:"watchPoolsObj",immediate:!0},"farmingv2.aprAndTvlObj":{handler:"watchAprAndTvlObj",immediate:!0},searchKey:function(e){this.filterDataList(e,this.currentType)},currentType:function(e){console.log("farmingv2##currentType##watch###",e),this.filterDataList(this.searchKey,e)}},methods:{importIcon:y.a,toCloseAccount:function(){return K(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.$wallet,n=this.$web3,r=Object(D.i)(n,t),o=new O.h(r.provider,[]),c=t.publicKey,o.instructions.unshift(Object(M.closeAccount)({source:new x.PublicKey("3KEQF6gdioh33zcoqdAoMhjVAQVJimPC152ec3AENvyr"),destination:c,owner:c})),e.next=8,this.confirmTx(o);case 8:case"end":return e.stop()}}),e,this)})))},watchAprAndTvlObj:function(e){console.log(e,"===?>???aprAndTvlObj"),this.aprAndTvlObj=e},filterDataList:function(e,t,n){var r=n||this.dataOriginList,o=[];if("Ended"!==t){console.log(e,t,n,"====>search, type, list"),o=r.filter((function(n){console.log("filterDataList####item###",n);var r=!0,o=!0;return e&&(r=n.name.toLowerCase().includes(e.toLowerCase())),"Live"!==t&&(o=n.quarries&&n.quarries.length>1),r&&o})),this.dataList=o,console.log(this.dataList,"dataList======>");for(var i=0;i<o.length;i++)this.toogleDataAll(i,o[i])}else this.dataList=o},toogleDataAll:function(e,t){this.$accessor.farmingv2.getPositionObjInfo({tvlData:this.tvlData,farmingInfo:t,rates:this.liquidity.rates,coinPairConfigObj:this.liquidity.poolsObj})},getIcon:function(e,t){if(this.liquidity.coinPairConfigObj&&this.liquidity.coinPairConfigObj[e]){var r=this.liquidity.coinPairConfigObj[e];return"a"===t?r.token_a.icon?r.token_a.icon:Object(y.a)("/coins/".concat(r.token_a.symbol.toLowerCase(),".png")):r.token_b.icon?r.token_b.icon:Object(y.a)("/coins/".concat(r.token_b.symbol.toLowerCase(),".png"))}return n(1150)},getRewardRange:function(e){if(this.liquidity.coinPairConfigObj&&this.liquidity.coinPairConfigObj[e]&&this.farmingv2.wrappersObj&&this.farmingv2.wrappersObj[e]){var t=this.liquidity.coinPairConfigObj[e],n=t.token_a,r=t.token_b,o=this.farmingv2.wrappersObj[e],c=-443632!==o.etrMin?Object($.c)(Object(_.f)(o.etrMin,n.decimal,r.decimal).toString(),6):"0",l=443632!==o.etrMax?Object($.c)(Object(_.f)(o.etrMax,n.decimal,r.decimal).toString(),6):"∞";return"".concat(c,"-").concat(l)}return"--"},getRewardNumber:function(e,t,n){var r=e.merge_pool.address;if(n&&n[r]&&n[r][t.reward_token_mint]){var o=n[r][t.reward_token_mint];if(o&&"0"!==o){console.log(this.rewardTokenObj,"====>this.rewardTokenObj"),console.log(t.reward_token_mint,"====>qitem.reward_token_mint");var c=this.rewardTokenObj[t.reward_token_mint].decimal||9,l=new C.a(o).div(Math.pow(10,c)).toString();return Number(l)<0?"0":Object($.a)(l,6)}}return"0"},gotoLp:function(e){if(this.wallet.connected){var t=this.liquidity.coinPairConfigObj&&this.liquidity.coinPairConfigObj[e.swap_key],n="",r="";if(t)console.log("gotoLp###info####",t),n=t.token_a.symbol,"WSOL"===t.token_a.symbol.toUpperCase()&&(n="SOL"),r=t.token_b.symbol,"WSOL"===t.token_b.symbol.toUpperCase()&&(r="SOL");else{var o=e.name.split("-");n=o[0],r=o[1]}this.$router.push("/deposit?from=".concat(n,"&to=").concat(r))}else this.$accessor.wallet.openModal()},watchPoolsObj:function(e){console.log(e,"=====>arr")},processNftAddress:function(address){return address?"".concat(address.substr(0,4),"...").concat(address.substr(address.length-4,4)):""},watchFarmingV2List:function(e){console.log("farmingv2###watchFarmingV2List###",e),this.dataOriginList=e,this.filterDataList(this.searchKey,this.currentType,e)},toogleData:function(e,t){var n=JSON.parse(JSON.stringify(this.isOpenArr));this.isOpenArr=Object.assign(Object.assign({},n),Object(c.a)({},e,!n[e])),n[e]||(console.log("toogleData###item####",t),console.log(this.tvlData,"this.tvlData======>"),console.log(t,"item======>"),console.log(this.liquidity.rates,"liquidity.rates======>"),console.log(this.liquidity.coinPairConfigObj,"this.liquidity.coinPairConfigObj======>"),this.$accessor.farmingv2.getPositionObj({tvlData:this.tvlData,farmingInfo:t,rates:this.liquidity.rates,coinPairConfigObj:this.liquidity.coinPairConfigObj}))},minerWrapper:function(e,t){return K(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,o,c,l,d,m;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=this.$wallet,o=this.$web3,c=Object(D.i)(o,r),n.next=5,c.mine.loadRewarderWrapper(e);case 5:return l=n.sent,n.next=8,R.k.load(c.provider.connection,t);case 8:return d=n.sent,Object(P.default)(null!==d),n.next=12,l.getQuarry(d);case 12:return m=n.sent,n.next=15,m.getMinerActions(r.publicKey);case 15:return n.abrupt("return",n.sent);case 16:case"end":return n.stop()}}),n,this)})))},toInitMinerV2:function(e,t,n,r){return K(this,void 0,void 0,regeneratorRuntime.mark((function c(){var l,d,m,h,f,w,k,y,v,P,$,T;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return l=this.$wallet,d=this.$web3,m=Object(D.i)(d,l),h=m.mergeMine.programs.MergeMine,c.next=6,Object(S.g)(t,n);case 6:return f=c.sent,w=Object(o.a)(f,1),k=w[0],c.next=11,Object(S.f)(k,r);case 11:return y=c.sent,v=Object(o.a)(y,1),P=v[0],$=new O.h(m.provider,[]),c.next=17,m.provider.getAccountInfo(P);case 17:if(c.sent){c.next=27;break}return c.next=20,Object(R.w)({provider:m.provider,mint:n,owner:P});case 20:return T=c.sent,$.instructions.unshift(h.instruction.initMinerV2({accounts:{pool:e,mm:r,miner:P,quarry:k,rewarder:t,tokenMint:n,minerVault:T.address,payer:m.provider.wallet.publicKey,mineProgram:S.b.Mine,systemProgram:x.SystemProgram.programId,tokenProgram:j.TOKEN_PROGRAM_ID}})),T.instruction&&$.instructions.unshift(T.instruction),console.log("toInitMinerV2####txEnv###",$),c.abrupt("return",$);case 27:console.error("HERE");case 28:case"end":return c.stop()}}),c,this)})))},confirmTx:function(e){return K(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={skipPreflight:!0,commitment:"confirmed",preflightCommitment:"confirmed",maxRetries:30,printLogs:!0},t.next=3,e.send(n);case 3:return r=t.sent,console.log("%s  confirming...",r.signature.toString()),t.next=7,r.wait({commitment:"confirmed",useWebsocket:!0,retries:30});case 7:return t.abrupt("return",t.sent);case 8:case"end":return t.stop()}}),t)})))},toStake:function(e,t){return K(this,void 0,void 0,regeneratorRuntime.mark((function n(){var o,c,l,d,m,h,f,w,k,y,v,O,$,_,C,M,K,A,L,i,U,W,N,I,F,E,V,H,Q,B,z,Y;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.stakeSuccess=!1,this.stakeFailed=!1,console.log("toStake###poolInfo###",e),console.log("toStake###positionInfo###",t),this.currentPosition=t,o=e.positionWrapper,c=e.merge_pool.address,l=e.quarries,d=t.nftTokenId||t.nftMint,m=this.$wallet,h=this.$web3,f=Object(D.i)(h,m),this.isStaking=!0,this.isDisabled=!0,this.$accessor.transaction.setTransactionDesc("Stake ".concat(e.name," NFT")),this.$accessor.transaction.setShowWaiting(!0),w="",n.prev=17,n.next=20,S.a.fetchPositionWrapper(new x.PublicKey(o),f.provider.connection);case 20:return k=n.sent,Object(P.default)(null!==k,"wrapper not found"),n.next=24,S.a.fetchSwapPositionByOwner(k.swapKey,d,f.provider.wallet.publicKey,f.provider.connection);case 24:return y=n.sent,Object(P.default)(null!==y,"Can't find the swap position you own"),v=f.mergeMine.loadMP({mpKey:new x.PublicKey(c)}),n.next=29,f.mergeMine.findMergeMinerAddress({owner:f.provider.wallet.publicKey,pool:new x.PublicKey(c)});case 29:return O=n.sent,console.log("toStake###mmKey###",O.toString()),n.next=33,f.positionWrapper.mintWrapTokens({wrapper:k,positionInfo:y,tokenProgram:j.TOKEN_PROGRAM_ID});case 33:return $=n.sent,console.log("toStake###mintRes.tx.instructions####",$.tx.instructions),_=Object(r.a)($.tx.instructions),n.next=38,Object(T.a)(m,new x.PublicKey(o),new x.PublicKey(d));case 38:return C=n.sent,console.log("toStake###多挖###stakeAmount###",C,"###",C.toString()),console.log("toStake###sdk123###",f),n.next=43,v.data();case 43:return M=n.sent,n.next=46,R.k.load(f.provider.connection,M.primaryMint);case 46:K=n.sent,Object(P.default)(null!==K,"The primary token is null"),A={},L=e.merge_pool.primary_mint,e.merge_pool.replica_mint,i=0;case 52:if(!(i<l.length)){n.next=70;break}if((U=l[i]).stake_token_mint!==L){n.next=62;break}return W=U.rewarder,n.next=58,v.deposit({amount:new R.l(K,C.toString()),rewarder:new x.PublicKey(W)});case 58:N=n.sent,i===l.length-1?((I=N.instructions).unshift.apply(I,Object(r.a)(_)),A=N):_.push.apply(_,Object(r.a)(N.instructions)),n.next=67;break;case 62:return F=U.rewarder,n.next=65,v.stakeReplicaMiner(new x.PublicKey(F),O);case 65:E=n.sent,i===l.length-1?((V=E.instructions).unshift.apply(V,Object(r.a)(_)),A=E):_.push.apply(_,Object(r.a)(E.instructions));case 67:i++,n.next=52;break;case 70:return H={skipPreflight:!0,commitment:"confirmed",preflightCommitment:"confirmed",maxRetries:30,printLogs:!0},console.log("toStake###tsx####",A),A.instructions.forEach((function(e,t){console.log("toStake###tsx###",t,"##item###",e.programId.toString())})),n.next=75,A.send(H);case 75:return Q=n.sent,this.$accessor.transaction.setShowWaiting(!1),Q&&Q.signature&&(w=Q.signature,console.log("走到这里了吗###",w),B="Stake ".concat(e.name," NFT"),this.$accessor.transaction.setShowSubmitted(!0),z=this,this.$accessor.transaction.sub({txid:w,description:B,type:"Stake",successCallback:function(){z.isStaking=!1,z.isDisabled=!1,z.$emit("refreshData"),z.$accessor.farmingv2.getPositionObj({tvlData:z.tvlData,farmingInfo:e,rates:z.liquidity.rates,coinPairConfigObj:z.liquidity.coinPairConfigObj}),z.stakeSuccess=!0},errorCallback:function(){z.isStaking=!1,z.isDisabled=!1,z.stakeFailed=!0}})),n.next=80,Q.wait({commitment:"confirmed",useWebsocket:!0,retries:30});case 80:Y=n.sent,console.log("whatWait####",Y),n.next=94;break;case 84:n.prev=84,n.t0=n.catch(17),console.log("toStakeTest##err###",n.t0),this.stakeFailed=!0,this.$accessor.transaction.setShowWaiting(!1),this.$accessor.transaction.setShowSubmitted(!1),this.isStaking=!1,this.isDisabled=!1,this.$notify.close(w+"loading"),this.$notify.error({key:"StakeErr",message:"Transaction failed",description:""});case 94:case"end":return n.stop()}}),n,this,[[17,84]])})))},toUnStake:function(e,t){var n;return K(this,void 0,void 0,regeneratorRuntime.mark((function o(){var c,l,d,m,h,f,w,k,y,v,O,j,$,T,_,M,i,K,A,L,U,W,N,I,F,E,V,H,Q,B,z,Y,G,J,Z,X,ee,te,ne,ie,re,ae,oe,se,ce,le,ue,de;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return console.log("toUnStake####poolInfo####",e),this.currentPosition=t,c=e.positionWrapper,l=e.merge_pool.address,d=e.quarries,m=new x.PublicKey(t.nftMintAddress),h=e.position_wrapper.wrap_mint,f=this.$wallet,w=this.$web3,k=Object(D.i)(w,f),this.isUnStaking=!0,this.isDisabled=!0,this.$accessor.transaction.setTransactionDesc("Unstake ".concat(e.name," NFT")),this.$accessor.transaction.setShowWaiting(!0),y="",o.prev=15,o.next=18,k.mergeMine.findMergeMinerAddress({pool:new x.PublicKey(l),owner:k.provider.wallet.publicKey});case 18:return v=o.sent,o.next=21,k.mergeMine.loadMM({mmKey:v});case 21:O=o.sent,j=k.mergeMine.loadMP({mpKey:new x.PublicKey(l)}),$=[],T=null,_=e.merge_pool.primary_mint,M=e.merge_pool.replica_mint,i=0;case 28:if(!(i<d.length)){o.next=76;break}if((K=d[i]).stake_token_mint!==_){o.next=56;break}return A=this.wallet.tokenAccounts,L=A&&A[h]&&(null===(n=A[h])||void 0===n?void 0:n.balance)||null,U=K.rewarder,W=t.wrapBalance,o.next=37,R.k.load(k.provider.connection,O.primaryMint);case 37:return N=o.sent,Object(P.default)(null!==N,"The primary token is null"),console.log("toUnStake###primaryTokenAmount###",W.toString()),console.log("toUnStake###userPosionWrapperBalance###",L),I=L?new C.a(W.toString()).sub(L.toWei().toString()):W,console.log("toUnStake###resPrimaryTokenAmount####",I.toString()),o.next=45,Object(R.w)({provider:k.provider,mint:new x.PublicKey(_),owner:k.provider.wallet.publicKey});case 45:return F=o.sent,E=F.address,V=F.instruction,console.log("toUnStake####primary ata address####",E&&E.toString(),"$$$$$$instruction####",V),V&&$.push(V),o.next=52,O.withdraw({amount:new R.l(N,I.toString()),rewarder:new x.PublicKey(U)});case 52:H=o.sent,$.push.apply($,Object(r.a)(H.instructions)),o.next=73;break;case 56:return console.log("toUnStake###is replica rewarder"),Q=K.rewarder,o.next=60,Object(R.w)({provider:k.provider,mint:new x.PublicKey(M),owner:k.provider.wallet.publicKey});case 60:return B=o.sent,z=B.address,Y=B.instruction,console.log("toUnStake####replica ata address####",z&&z.toString(),"$$$$$$instruction####",Y),Y&&$.unshift(Y),o.next=67,O.unstakeAllReplica(new x.PublicKey(Q));case 67:return G=o.sent,$.unshift.apply($,Object(r.a)(G.instructions)),o.next=71,j.stakeReplicaMiner(new x.PublicKey(Q),v);case 71:J=o.sent,T?(Z=T.instructions).push.apply(Z,Object(r.a)(J.instructions)):T=J;case 73:i++,o.next=28;break;case 76:return o.next=78,Object(R.w)({provider:k.provider,mint:m,owner:k.provider.wallet.publicKey});case 78:return X=o.sent,ee=X.address,te=X.instruction,o.next=83,S.a.fetchPositionWrapper(new x.PublicKey(c),k.provider.connection);case 83:return ne=o.sent,Object(P.default)(null!==ne,"wrapper not found"),o.next=87,k.positionWrapper.burnWrapTokens({wrapper:ne,nftMint:m,nftAccount:ee});case 87:return ie=o.sent,re=null,T?(console.log("toUnStake####stakeReplicaResAll####",T),$.push.apply($,Object(r.a)(ie.instructions)),(ae=T.instructions).unshift.apply(ae,$),re=T):((oe=ie.instructions).unshift.apply(oe,$),te&&ie.instructions.unshift(te),re=ie,console.log("toUnStake####burnRes####",ie)),se={skipPreflight:!0,commitment:"confirmed",preflightCommitment:"confirmed",maxRetries:30,printLogs:!0},console.log("toUnStake###tsx###",re),o.next=94,re.send(se);case 94:return ce=o.sent,this.$accessor.transaction.setShowWaiting(!1),ce&&ce.signature&&(y=ce.signature,le="Unstake ".concat(e.name," NFT"),this.$accessor.transaction.setShowSubmitted(!0),ue=this,this.$accessor.transaction.sub({txid:y,description:le,type:"Unstake",successCallback:function(){ue.isUnStaking=!1,ue.isDisabled=!1,ue.$emit("refreshData"),ue.$accessor.farmingv2.getPositionObj({tvlData:ue.tvlData,farmingInfo:e,rates:ue.liquidity.rates,coinPairConfigObj:ue.liquidity.coinPairConfigObj})},errorCallback:function(){ue.isUnStaking=!1,ue.isDisabled=!1}})),o.next=99,ce.wait({commitment:"confirmed",useWebsocket:!0,retries:30});case 99:de=o.sent,console.log("whatWait####",de),o.next=112;break;case 103:o.prev=103,o.t0=o.catch(15),console.log("toUnStake###error###",o.t0),this.$accessor.transaction.setShowWaiting(!1),this.$accessor.transaction.setShowSubmitted(!1),this.isUnStaking=!1,this.isDisabled=!1,this.$notify.close(y+"loading"),this.$notify.error({key:"UnStakeErr",message:"Transaction failed",description:""});case 112:case"end":return o.stop()}}),o,this,[[15,103]])})))},redeemTokensAllIx:function(e,t,n){return K(this,void 0,void 0,regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.getRedeemTokenAccounts(n);case 2:return o=r.sent,r.abrupt("return",e.instruction.redeemAllTokens({accounts:{redeemer:o.redeemer,sourceAuthority:o.sourceAuthority,iouMint:o.iouMint,iouSource:o.iouSource,redemptionVault:o.redemptionVault,redemptionDestination:o.redemptionDestination,tokenProgram:j.TOKEN_PROGRAM_ID}}));case 4:case"end":return r.stop()}}),r)})))},redeemAllTokens:function(e,t,n){return K(this,void 0,void 0,regeneratorRuntime.mark((function o(){var c,l,d,m,h;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return c=e.programs.Redeemer,o.next=3,e.loadRedeemer({iouMint:t,redemptionMint:n});case 3:return l=o.sent,o.next=6,Object(R.u)({mint:t,owner:e.provider.wallet.publicKey});case 6:return d=o.sent,o.next=9,Object(R.w)({provider:e.provider,mint:n,owner:e.provider.wallet.publicKey});case 9:return m=o.sent,h={tokenAmount:new j.u64(1),sourceAuthority:e.provider.wallet.publicKey,iouSource:d,redemptionDestination:m.address},o.t0=O.h,o.t1=e.provider,o.t2=[],o.t3=Object(r.a)(m.instruction?[m.instruction]:[]),o.next=17,this.redeemTokensAllIx(c,l,h);case 17:return o.t4=o.sent,o.t5=[o.t4],o.t6=o.t2.concat.call(o.t2,o.t3,o.t5),o.abrupt("return",new o.t0(o.t1,o.t6));case 21:case"end":return o.stop()}}),o,this)})))},toClaim:function(e,t){return K(this,void 0,void 0,regeneratorRuntime.mark((function n(){var o,c,l,d,m,h,f,w,k,y,v,S,O,j,P,R,$,T,_;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return console.log("toClaim###farmingInfo###",e),console.log("toClaim###qitem###",t),o=this.$wallet,c=this.$web3,l=Object(D.i)(c,o),e.positionWrapper,d=e.merge_pool.address,n.next=9,l.mergeMine.findMergeMinerAddress({pool:new x.PublicKey(d),owner:l.provider.wallet.publicKey});case 9:return m=n.sent,n.next=12,l.mergeMine.loadMM({mmKey:m});case 12:if(h=n.sent,f=new x.PublicKey(t.rewarder),w=e.redeemers,this.isClaiming=!0,this.isDisabled=!0,k=this.rewardTokenObj[t.reward_token_mint],this.$accessor.transaction.setTransactionDesc("Harvest ".concat(k.name," rewards")),this.$accessor.transaction.setShowWaiting(!0),y="",n.prev=21,v=null,S=e.merge_pool.primary_mint,e.merge_pool.replica_mint,t.stake_token_mint!==S){n.next=31;break}return n.next=28,h.claimPrimaryRewards(f);case 28:v=n.sent,n.next=34;break;case 31:return n.next=33,h.claimReplicaRewards(f);case 33:v=n.sent;case 34:if(!w||!w[t.reward_token_mint]){n.next=39;break}return n.next=37,this.redeemAllTokens(l,new x.PublicKey(t.reward_token_mint),new x.PublicKey(w[t.reward_token_mint].redemption_mint));case 37:j=n.sent,(O=v.instructions).push.apply(O,Object(r.a)(j.instructions));case 39:return P={skipPreflight:!0,commitment:"confirmed",preflightCommitment:"confirmed",maxRetries:30,printLogs:!0},n.next=42,v.send(P);case 42:if(R=n.sent,this.$accessor.transaction.setShowWaiting(!1),!R||!R.signature){n.next=54;break}return y=R.signature,$="Harvest ".concat(k.name," rewards"),T=this,this.$accessor.transaction.setShowSubmitted(!0),this.$accessor.transaction.sub({txid:y,description:$,type:"Harvest",successCallback:function(){T.isClaiming=!1,T.isDisabled=!1,T.$emit("refreshData"),T.$accessor.farmingv2.getPositionObj({tvlData:T.tvlData,farmingInfo:e,rates:T.liquidity.rates,coinPairConfigObj:T.liquidity.coinPairConfigObj})},errorCallback:function(){T.isClaiming=!1,T.isDisabled=!1}}),n.next=52,R.wait({commitment:"confirmed",useWebsocket:!0,retries:30});case 52:_=n.sent,console.log("whatWait####",_);case 54:n.next=65;break;case 56:n.prev=56,n.t0=n.catch(21),console.log("toClaim###err###",n.t0),this.$accessor.transaction.setShowWaiting(!1),this.$accessor.transaction.setShowSubmitted(!1),this.isClaiming=!1,this.isDisabled=!1,this.$notify.close(y+"loading"),this.$notify.error({key:"HarvestErr",message:"Transaction failed",description:""});case 65:case"end":return n.stop()}}),n,this,[[21,56]])})))}}})}}]);