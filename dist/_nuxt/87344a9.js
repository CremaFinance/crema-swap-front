/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{1669:function(e,t,n){"use strict";var r=n(17),o=n(781);r({target:"String",proto:!0,forced:n(782)("fixed")},{fixed:function(){return o(this,"tt","","")}})},1983:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return Fe}));var r=n(8),o=n.n(r),c=n(10),l=n(1984),f=n(0),d=n(13),h=n.n(d),y=n(7);function w(e,t,n,r,o,c,l){try{var f=e[c](l),d=f.value}catch(e){return void n(e)}f.done?t(d):Promise.resolve(d).then(r,o)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var c=e.apply(t,n);function l(e){w(c,r,o,l,f,"next",e)}function f(e){w(c,r,o,l,f,"throw",e)}l(void 0)}))}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function v(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var S=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){var t=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",l=o.asyncIterator||"@@asyncIterator",f=o.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function h(e,t,n,r){var o=t&&t.prototype instanceof O?t:O,c=Object.create(o.prototype),l=new U(r||[]);return c._invoke=function(e,t,n){var r=w;return function(o,c){if(r===k)throw new Error("Generator is already running");if(r===v){if("throw"===o)throw c;return G()}for(n.method=o,n.arg=c;;){var l=n.delegate;if(l){var f=D(l,n);if(f){if(f===S)continue;return f}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===w)throw r=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=k;var d=y(e,t,n);if("normal"===d.type){if(r=n.done?v:m,d.arg===S)continue;return{value:d.arg,done:n.done}}"throw"===d.type&&(r=v,n.method="throw",n.arg=d.arg)}}}(e,n,l),c}function y(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=h;var w="suspendedStart",m="suspendedYield",k="executing",v="completed",S={};function O(){}function I(){}function T(){}var x={};d(x,c,(function(){return this}));var E=Object.getPrototypeOf,j=E&&E(E(N([])));j&&j!==n&&r.call(j,c)&&(x=j);var A=T.prototype=O.prototype=Object.create(x);function P(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function L(e,t){function n(o,c,l,f){var d=y(e[o],e,c);if("throw"!==d.type){var h=d.arg,w=h.value;return w&&"object"==typeof w&&r.call(w,"__await")?t.resolve(w.__await).then((function(e){n("next",e,l,f)}),(function(e){n("throw",e,l,f)})):t.resolve(w).then((function(e){h.value=e,l(h)}),(function(e){return n("throw",e,l,f)}))}f(d.arg)}var o;this._invoke=function(e,r){function c(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(c,c):c()}}function D(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,D(e,n),"throw"===n.method))return S;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var o=y(r,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,S;var c=o.arg;return c?c.done?(n[e.resultName]=c.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,S):c:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,S)}function B(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function K(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function U(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(B,this),this.reset(!0)}function N(e){if(e){var n=e[c];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:G}}function G(){return{value:t,done:!0}}return I.prototype=T,d(A,"constructor",T),d(T,"constructor",I),I.displayName=d(T,f,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===I||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,T):(e.__proto__=T,d(e,f,"GeneratorFunction")),e.prototype=Object.create(A),e},e.awrap=function(e){return{__await:e}},P(L.prototype),d(L.prototype,l,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,r,o,c){void 0===c&&(c=Promise);var l=new L(h(t,n,r,o),c);return e.isGeneratorFunction(n)?l:l.next().then((function(e){return e.done?e.value:l.next()}))},P(A),d(A,f,"Generator"),d(A,c,(function(){return this})),d(A,"toString",(function(){return"[object Generator]"})),e.keys=function(object){var e=[];for(var t in object)e.push(t);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in object)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=N,U.prototype={constructor:U,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(K),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return l.type="throw",l.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var c=this.tryEntries[i],l=c.completion;if("root"===c.tryLoc)return o("end");if(c.tryLoc<=this.prev){var f=r.call(c,"catchLoc"),d=r.call(c,"finallyLoc");if(f&&d){if(this.prev<c.catchLoc)return o(c.catchLoc,!0);if(this.prev<c.finallyLoc)return o(c.finallyLoc)}else if(f){if(this.prev<c.catchLoc)return o(c.catchLoc,!0)}else{if(!d)throw new Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return o(c.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var c=o?o.completion:{};return c.type=e,c.arg=t,o?(this.method="next",this.next=o.finallyLoc,S):this.complete(c)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),S},finish:function(e){for(var i=this.tryEntries.length-1;i>=0;--i){var t=this.tryEntries[i];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),K(t),S}},catch:function(e){for(var i=this.tryEntries.length-1;i>=0;--i){var t=this.tryEntries[i];if(t.tryLoc===e){var n=t.completion;if("throw"===n.type){var r=n.arg;K(t)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),S}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}));o.a.config({precision:64,rounding:o.a.ROUND_DOWN,toExpNeg:-64,toExpPos:64});var O,I=new o.a(10),T=new o.a(2).pow(64),x=T.div(2).sub(1),E=T.div(2).neg(),j=T.sub(1),A=T.pow(63).sub(1),P=A.neg(),L=T.pow(64).sub(1),D=40,B=function(){function e(){}return e.from64Buffer=function(e,t){if(void 0===t&&(t=0),8!==e.length&&Object(c.default)(!1),Math.abs(t)<D||Object(c.default)(!1),e[7]>=128){for(var n,r=[],l=v(e);!(n=l()).done;){var f=n.value;r.push(("00"+Math.abs(255&~f).toString(16)).slice(-2))}var d=new h.a(r.join(""),16,"le").add(new h.a(1)).neg();return new o.a(d.toString()).div(I.pow(t))}return new o.a(new h.a(e,"le").toString()).div(I.pow(t))},e.fromU64Buffer=function(e,t){return void 0===t&&(t=0),8!==e.length&&Object(c.default)(!1),Math.abs(t)<D||Object(c.default)(!1),new o.a(new h.a(e,16,"le").toString()).div(I.pow(t))},e.from128Buffer=function(e,t){if(void 0===t&&(t=0),16!==e.length&&Object(c.default)(!1),Math.abs(t)<D||Object(c.default)(!1),e[15]>=128){for(var n,r=[],l=v(e);!(n=l()).done;){var f=n.value;r.push(("00"+Math.abs(255&~f).toString(16)).slice(-2))}var d=new h.a(r.join(""),16,"le").add(new h.a(1)).neg();return new o.a(d.toString()).div(I.pow(t))}return new o.a(new h.a(e,"le").toString()).div(I.pow(t))},e.fromU128Buffer=function(e,t){return void 0===t&&(t=0),16!==e.length&&Object(c.default)(!1),Math.abs(t)<D||Object(c.default)(!1),new o.a(new h.a(e,"le").toString()).div(I.pow(t))},e.to64Buffer=function(e,t){void 0===t&&(t=0),Math.abs(t)<D||Object(c.default)(!1),(e=e.mul(I.pow(t)).round()).greaterThanOrEqualTo(E)&&e.lessThanOrEqualTo(x)||Object(c.default)(!1);var n=new h.a(e.toString());if(n.isNeg()){var r=n.add(new h.a(1)).toBuffer("le",8);return r.forEach((function(e,t,input){input[t]=255&~e})),r}return n.toBuffer("le",8)},e.toU64Buffer=function(e,t){return void 0===t&&(t=0),Math.abs(t)<D||Object(c.default)(!1),(e=e.mul(I.pow(t)).round()).greaterThanOrEqualTo(0)&&e.lessThanOrEqualTo(j)||Object(c.default)(!1),new h.a(e.toString()).toBuffer("le",8)},e.to128Buffer=function(e,t){void 0===t&&(t=0),Math.abs(t)<D||Object(c.default)(!1),(e=e.mul(I.pow(t)).round()).greaterThanOrEqualTo(P)&&e.lessThanOrEqualTo(A)||Object(c.default)(!1);var n=new h.a(e.toString());if(n.isNeg()){var r=n.add(new h.a(1)).toBuffer("le",16);return r.forEach((function(e,t,input){input[t]=255&~e})),r}return n.toBuffer("le",16)},e.toU128Buffer=function(e,t){return void 0===t&&(t=0),Math.abs(t)<D||Object(c.default)(!1),(e=e.mul(I.pow(t)).round()).greaterThanOrEqualTo(0)&&e.lessThanOrEqualTo(L)||Object(c.default)(!1),new h.a(e.toString()).toBuffer("le",16)},e}(),K=function(e){void 0===e&&(e="publicKey");var t=Object(l.blob)(32,e),n=function(e){return{decode:e.decode.bind(e),encode:e.encode.bind(e)}}(t),r=n.encode,o=n.decode,c=t;return c.decode=function(e,t){var n=o(e,t);return new f.PublicKey(n)},c.encode=function(e,t,n){var o=e.toBuffer();return r(o,t,n)},c},U=function(t,n){void 0===t&&(t="uint64"),void 0===n&&(n=0);var r=Object(l.blob)(8,t),o=r.decode.bind(r),c=r.encode.bind(r),f=r;return f.decode=function(t,r){var c=e.from(o(t,r));return B.fromU64Buffer(c,n)},f.encode=function(e,t,r){var o=B.toU64Buffer(e,n);return c(o,t,r)},f},N=function(t,n){void 0===t&&(t="uint64"),void 0===n&&(n=0);var r=Object(l.blob)(16,t),o=r.decode.bind(r),c=r.encode.bind(r),f=r;return f.decode=function(t,r){var c=e.from(o(t,r));return B.from128Buffer(c,n)},f.encode=function(e,t,r){var o=B.to128Buffer(e,n);return c(o,t,r)},f},G=function(t,n){void 0===t&&(t="uint64"),void 0===n&&(n=0);var r=Object(l.blob)(16,t),o=r.decode.bind(r),c=r.encode.bind(r),f=r;return f.decode=function(t,r){var c=e.from(o(t,r));return B.fromU128Buffer(c,n)},f.encode=function(e,t,r){var o=B.toU128Buffer(e,n);return c(o,t,r)},f};function _(e,t){return W.apply(this,arguments)}function W(){return W=m(S.mark((function e(t,n){var r,o,c,l=arguments;return S.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=l.length,o=new Array(r>2?r-2:0),c=2;c<r;c++)o[c-2]=l[c];return e.abrupt("return",Object(f.sendAndConfirmTransaction)(t,n,o,{skipPreflight:!1,commitment:"recent",preflightCommitment:"recent"}));case 2:case"end":return e.stop()}}),e)}))),W.apply(this,arguments)}function R(e,t){return M.apply(this,arguments)}function M(){return(M=m(S.mark((function e(t,n){return S.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.Token.getAssociatedTokenAddress(y.ASSOCIATED_TOKEN_PROGRAM_ID,y.TOKEN_PROGRAM_ID,t,n,!0);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,t,n,r){return y.Token.createAssociatedTokenAccountInstruction(y.ASSOCIATED_TOKEN_PROGRAM_ID,y.TOKEN_PROGRAM_ID,e,t,n,r)}function C(e,t){return V.apply(this,arguments)}function V(){return(V=m(S.mark((function e(t,n){var r,o,i,l,f,d,h;return S.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getTokenAccountsByOwner(n,{programId:y.TOKEN_PROGRAM_ID});case 2:for(r=e.sent,o=[],i=0;i<r.value.length;i++)l=r.value[i],f=l.pubkey,null==(null==(d=l.account)?void 0:d.data)&&Object(c.default)(!1),(h=z(d)).address=f,o.push(h);return e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e){null==(null==e?void 0:e.data)&&Object(c.default)(!1);var t=y.AccountLayout.decode(null==e?void 0:e.data);return t.mint=new f.PublicKey(t.mint),t.owner=new f.PublicKey(t.owner),t.amount=y.u64.fromBuffer(t.amount),0===t.delegateOption?(t.delegate=null,t.delegatedAmount=new y.u64(0)):(t.delegate=new f.PublicKey(t.delegate),t.delegatedAmount=y.u64.fromBuffer(t.delegatedAmount)),t.isInitialized=0!==t.state,t.isFrozen=2===t.state,1===t.isNativeOption?(t.rentExemptReserve=y.u64.fromBuffer(t.isNative),t.isNative=!0):(t.rentExemptReserve=null,t.isNative=!1),0===t.closeAuthorityOption?t.closeAuthority=null:t.closeAuthority=new f.PublicKey(t.closeAuthority),t}!function(e){e[e.Initialize=0]="Initialize",e[e.Swap=1]="Swap",e[e.DepositAllTokenTypes=2]="DepositAllTokenTypes",e[e.WithdrawAllTokenTypes=3]="WithdrawAllTokenTypes",e[e.Claim=4]="Claim",e[e.ManagerClaim=5]="ManagerClaim",e[e.AddUserPosition=6]="AddUserPosition",e[e.UpdateFee=7]="UpdateFee",e[e.SimulateSwap=8]="SimulateSwap"}(O||(O={}));var $=Object(l.struct)([Object(l.u8)("instruction")]),H=function(t,n,r){var data=e.alloc($.span);$.encode({instruction:O.AddUserPosition},data);var o=[{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:y.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new f.TransactionInstruction({keys:o,programId:t,data:data})},J=Object(l.struct)([Object(l.u8)("instruction"),U("positionIndex")]),Y=function(t,n,r,o,c,l,d,h,w,m,k,v,S){var data=e.alloc(J.span);J.encode({instruction:O.Claim,positionIndex:S},data);var I=[{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!1},{pubkey:v,isSigner:!1,isWritable:!0},{pubkey:y.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new f.TransactionInstruction({keys:I,programId:t,data:data})},Q=Object(l.struct)([Object(l.u8)("instruction"),Object(l.u8)("isNewPosition"),G("liquityAmount"),Object(l.s32)("tickLower"),Object(l.s32)("tickUpper"),U("maximumTokenA"),U("maximumTokenB"),U("positionIndex")]),X=function(t,n,r,o,c,l,d,h,w,m,k,v,S,I,T,x,E,j,A){var data=e.alloc(Q.span);Q.encode({instruction:O.DepositAllTokenTypes,isNewPosition:S,liquityAmount:x,tickLower:I,tickUpper:T,maximumTokenA:E,maximumTokenB:j,positionIndex:A},data);var P=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:w,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!0},{pubkey:v,isSigner:!1,isWritable:!0},{pubkey:y.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new f.TransactionInstruction({keys:P,programId:t,data:data})},Z=Object(l.struct)([Object(l.u8)("instruction"),Object(l.u8)("nonce"),Object(l.u8)("curveType"),U("fee",12),U("managerFee",12),Object(l.u32)("tickSpace"),G("currentSqrtPrice",12),G("currentLiquity"),G("feeGrowthGlobal0"),G("feeGrowthGlobal1"),G("managerFeeA"),G("managerFeeB")]),ee=function(t,n,r,c,l,d,h,w,m,k,v,S,I,T,x,E){var data=e.alloc(Z.span);Z.encode({instruction:O.Initialize,nonce:v,curveType:S,fee:I,managerFee:T,tickSpace:x,currentSqrtPrice:E,currentLiquity:new o.a(0),feeGrowthGlobal0:new o.a(0),feeGrowthGlobal1:new o.a(0),managerFeeA:new o.a(0),managerFeeB:new o.a(0)},data);var j=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:h,isSigner:!1,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!0},{pubkey:y.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new f.TransactionInstruction({keys:j,programId:t,data:data})},te=Object(l.struct)([Object(l.u8)("instruction")]),ne=function(t,n,r,o,c,l,d,h){var data=e.alloc(te.span);te.encode({instruction:O.ManagerClaim},data);var w=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:y.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new f.TransactionInstruction({keys:w,programId:t,data:data})},re=Object(l.struct)([Object(l.u8)("instruction"),U("amountIn"),U("minimumAmountOut")]),ie=function(t,n,r,o,c,l,d,h,w,m,k){var data=e.alloc(re.span);re.encode({instruction:O.Swap,amountIn:m,minimumAmountOut:k},data);var v=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:w,isSigner:!1,isWritable:!0},{pubkey:y.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new f.TransactionInstruction({keys:v,programId:t,data:data})},oe=Object(l.struct)([Object(l.u8)("instruction"),U("liquityAmount"),U("minimumTokenA"),U("minimumTokenB"),U("positionIndex")]),ae=function(t,n,r,o,c,l,d,h,w,m,k,v,S,I,T,x){var data=e.alloc(oe.span);oe.encode({instruction:O.WithdrawAllTokenTypes,liquityAmount:S,minimumTokenA:I,minimumTokenB:T,positionIndex:x},data);var E=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!0},{pubkey:v,isSigner:!1,isWritable:!0},{pubkey:y.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}];return new f.TransactionInstruction({keys:E,programId:t,data:data})},se=Object(l.struct)([Object(l.u8)("instruction"),U("amountIn"),Object(l.u8)("direction")]),ue=function(t,n,r,o,c){var data=e.alloc(se.span);se.encode({instruction:O.SimulateSwap,amountIn:o,direction:c},data);var l=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0}];return new f.TransactionInstruction({keys:l,programId:t,data:data})},ce=504e3,le=Object(l.struct)([Object(l.s32)("tick"),G("tickPrice",12),G("liquityGross"),N("liquityNet"),G("feeGrowthOutside0",16),G("feeGrowthOutside1",16)],"tickInfo"),pe=Object(l.struct)([Object(l.u8)("swapVersion"),K("tokenSwapKey"),Object(l.u8)("accountType"),Object(l.s32)("len"),Object(l.blob)(503962,"dataFlat")],"ticksAccount"),fe=function(e){return e.data.length===ce},de=function(t,n){if(fe(n)){var r=e.from(n.data),o=pe.decode(r),c=o.swapVersion,f=o.tokenSwapKey,d=o.accountType,h=o.len,y=o.dataFlat,w=h*le.span,m=y.slice(0,w);return{pubkey:t,info:n,data:{swapVersion:c,tokenSwapKey:f,accountType:d,len:h,ticks:Object(l.seq)(le,h).decode(m)}}}},he=36e4,ye=Object(l.struct)([K("nftTokenId"),Object(l.s32)("lowerTick"),Object(l.s32)("upperTick"),G("liquity"),G("feeGrowthInsideALast",16),G("feeGrowthInsideBLast",16),G("tokenAFee",16),G("tokenBFee",16)],"position"),be=Object(l.struct)([Object(l.u8)("swapVersion"),K("tokenSwapKey"),Object(l.u8)("accountType"),Object(l.s32)("len"),Object(l.blob)(359962,"dataFlat")],"positionsAccount"),we=Math.floor(359962/ye.span),me=function(e){return e.data.length===he},ge=function(t,n){if(me(n)){var r=e.from(n.data),o=be.decode(r),c=o.swapVersion,f=o.tokenSwapKey,d=o.accountType,h=o.len,y=o.dataFlat,w=h*ye.span,m=y.slice(0,w);return{pubkey:t,info:n,data:{swapVersion:c,tokenSwapKey:f,accountType:d,len:h,positions:Object(l.seq)(ye,h).decode(m)}}}},ke=Object(l.struct)([K("tokenSwapKey"),Object(l.u8)("accountType"),Object(l.u8)("version"),Object(l.u8)("isInitialized"),Object(l.u8)("nonce"),K("tokenProgramId"),K("manager"),K("managerTokenA"),K("managerTokenB"),K("swapTokenA"),K("swapTokenB"),K("tokenAMint"),K("tokenBMint"),K("ticksKey"),K("positionsKey"),Object(l.u8)("curveType"),U("fee",12),U("managerFee",12),Object(l.u32)("tickSpace"),G("currentSqrtPrice",12),G("currentLiquity"),G("feeGrowthGlobal0",16),G("feeGrowthGlobal1",16),G("managerFeeA"),G("managerFeeB")],"tokenSwapAccount"),ve=ke.span,Se=function(e){return e.data.length===ve},Oe=function(t,n){if(Se(n)){var r=e.from(n.data);return{pubkey:t,info:n,data:ke.decode(r)}}},Ie=443632,Te=-443632,xe=new r.Decimal("1.0001"),Ee=new r.Decimal("1e-12"),je=xe.pow(Ie),Ae=xe.pow(Te),Pe=xe.pow(221816),Le=xe.pow(-221816);function De(e){return e.lessThan(Pe)||Object(c.default)(!1),e.greaterThan(Le)||Object(c.default)(!1),e.pow(2).log(xe).toDP(0,r.Decimal.ROUND_HALF_UP).toNumber()}function Be(e){return e>=Te&&e<=Ie||Object(c.default)(!1),xe.pow(e/2)}function Ke(e,t){t>0&&t%1==0||Object(c.default)(!1),e.lessThan(je)||Object(c.default)(!1),e.greaterThan(Ae)||Object(c.default)(!1);var n=function(e){return e.lessThan(je)||Object(c.default)(!1),e.greaterThan(Ae)||Object(c.default)(!1),e.log(xe).toDP(0,r.Decimal.ROUND_HALF_UP).toNumber()}(e),o=(n-Te)%t;return o>t/2?n-o+t:n-o}function Ue(e,t,n){return n.div(e).toDP(0,r.Decimal.ROUND_DOWN).sub(n.div(t).toDP(0,r.Decimal.ROUND_DOWN))}function Ne(e,t,n){return n.mul(t.sub(e)).toDP(0,r.Decimal.ROUND_DOWN)}function Ge(e,t,n){var o=t.div(n.add(t.div(e))),c=n.add(t.div(e).toDP(0,r.Decimal.ROUND_DOWN));return{amountOut:t.mul(e).toDP(0,r.Decimal.ROUND_DOWN).sub(t.mul(t).div(c).toDP(0,r.Decimal.ROUND_DOWN)),afterSqrtPrice:o}}function _e(e,t,n){var o=n.div(t).add(e),c=n.add(t.mul(e).toDP(0,r.Decimal.ROUND_DOWN));return{amountOut:t.div(e).toDP(0,r.Decimal.ROUND_DOWN).sub(t.mul(t).div(c).toDP(0,r.Decimal.ROUND_DOWN)),afterSqrtPrice:o}}function qe(e,t,n,r,l){e<t||Object(c.default)(!1);var f=Be(e),d=Be(t);r.greaterThanOrEqualTo(f)&&r.lessThanOrEqualTo(d)||Object(c.default)(!1);var h=new o.a(1);if(0===l){var y=n.div(h.div(r).sub(h.div(d)));return{desiredAmountDst:y.mul(r.sub(f)),deltaLiquity:y}}var w=n.div(r.sub(f));return{desiredAmountDst:w.mul(h.div(r).sub(h.div(d))),deltaLiquity:w}}function We(e,t,n){e<t||Object(c.default)(!1);var r=Be(e),l=Be(t),f=new o.a(1);return n.div(f.div(r).sub(f.div(l)))}function Re(e,t,n){e<t||Object(c.default)(!1);var r=Be(e),o=Be(t);return n.div(o.sub(r))}var Me=new f.PublicKey("11111111111111111111111111111111");o.a.config({precision:64,rounding:o.a.ROUND_HALF_DOWN,toExpNeg:-64,toExpPos:64});var Fe=function(){function e(e,t,n,r){this.programId=Me,this.tokenSwapKey=Me,this.authority=Me,this.isLoaded=!1,this.currentTick=0,this.tokenSwapInfo={tokenSwapKey:Me,accountType:0,version:0,isInitialized:0,nonce:0,tokenProgramId:y.TOKEN_PROGRAM_ID,manager:Me,managerTokenA:Me,managerTokenB:Me,swapTokenA:Me,swapTokenB:Me,tokenAMint:Me,tokenBMint:Me,ticksKey:Me,positionsKey:Me,curveType:0,fee:new o.a(0),managerFee:new o.a(0),tickSpace:0,currentSqrtPrice:new o.a(0),currentLiquity:new o.a(0),feeGrowthGlobal0:new o.a(0),feeGrowthGlobal1:new o.a(0),managerFeeA:new o.a(0),managerFeeB:new o.a(0)},this.ticks=[],this.conn=e,this.tokenSwapKey=n,this.programId=t,this.payer=r,this.positions=new Map,this.positionsKeys=new Map}var t=e.prototype;return t.setDefaultPayer=function(e){this.payer=e},t.load=function(){var e=m(S.mark((function e(){var t,n,r,l=this;return S.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={encoding:"base64",filters:[{memcmp:{offset:1,bytes:this.tokenSwapKey.toBase58()}}]},e.next=3,this.conn.getProgramAccounts(this.programId,t);case 3:if(e.sent.map((function(e){if(Se(e.account)){var t=Oe(e.pubkey,e.account);void 0===(null==t?void 0:t.data)&&Object(c.default)(!1),l.tokenSwapInfo=t.data}else if(fe(e.account)){var n=de(e.pubkey,e.account);void 0===(null==n?void 0:n.data)&&Object(c.default)(!1),l.ticks=n.data.ticks}else if(me(e.account)){var r=ge(e.pubkey,e.account);void 0===(null==r?void 0:r.data)&&Object(c.default)(!1),l.positionsKeys.set(e.pubkey,r.data.positions.length);for(var i=0;i<r.data.positions.length;i++){var p=r.data.positions[i];l.positions.set(p.nftTokenId.toBase58(),{positionsKey:e.pubkey,index:new o.a(i),positionId:p.nftTokenId,lowerTick:p.lowerTick,upperTick:p.upperTick,liquity:p.liquity,feeGrowthInsideALast:p.feeGrowthInsideALast,feeGrowthInsideBLast:p.feeGrowthInsideBLast,tokenAFee:p.tokenAFee,tokenBFee:p.tokenBFee})}}else console.log("the account:%s length:%d unkown",e.pubkey.toString(),e.account.data.length)})),this.authority.toString()!==Me.toString()){e.next=11;break}return e.next=8,f.PublicKey.findProgramAddress([this.tokenSwapKey.toBuffer()],this.programId);case 8:n=e.sent,r=n[0],this.authority=r;case 11:return this.isLoaded=!0,this.currentTick=De(this.tokenSwapInfo.currentSqrtPrice),e.abrupt("return",this);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e.createTokenSwap=function(){var t=m(S.mark((function t(n,r,o,c,l,d,h,w,m,k,v){var O,I,T,x,E,j,A,P,L,D,B,K,U,N,G,W,M,C;return S.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===v&&(v=!1),O=f.Keypair.generate(),I=f.Keypair.generate(),T=f.Keypair.generate(),t.next=6,f.PublicKey.findProgramAddress([O.publicKey.toBuffer()],r);case 6:return x=t.sent,E=x[0],j=x[1],t.next=11,n.getMinimumBalanceForRentExemption(ce);case 11:return A=t.sent,t.next=14,n.getMinimumBalanceForRentExemption(he);case 14:return P=t.sent,t.next=17,n.getMinimumBalanceForRentExemption(ve);case 17:return L=t.sent,D=(new f.Transaction).add(f.SystemProgram.createAccount({fromPubkey:k.publicKey,newAccountPubkey:O.publicKey,lamports:L,space:ve,programId:r}),f.SystemProgram.createAccount({fromPubkey:k.publicKey,newAccountPubkey:I.publicKey,lamports:A,space:ce,programId:r}),f.SystemProgram.createAccount({fromPubkey:k.publicKey,newAccountPubkey:T.publicKey,lamports:P,space:he,programId:r})),t.next=21,R(o,E);case 21:return B=t.sent,t.next=24,R(c,E);case 24:return K=t.sent,D.add(F(o,B,E,k.publicKey),F(c,K,E,k.publicKey)),U=m.sqrt(),N=new y.Token(n,o,y.TOKEN_PROGRAM_ID,k),G=new y.Token(n,c,y.TOKEN_PROGRAM_ID,k),t.next=31,N.getOrCreateAssociatedAccountInfo(l);case 31:return W=t.sent,t.next=34,G.getOrCreateAssociatedAccountInfo(l);case 34:return M=t.sent,0,D.add(ee(r,O.publicKey,E,l,W.address,M.address,B,K,I.publicKey,T.publicKey,j,0,d,h,w,U)),t.next=39,_(n,D,k,O,I,T);case 39:return C=t.sent,v&&console.log(C),t.next=43,new e(n,r,O.publicKey,k).load();case 43:return t.abrupt("return",t.sent);case 44:case"end":return t.stop()}}),t)})));return function(e,n,r,o,c,l,f,d,h,y,w){return t.apply(this,arguments)}}(),t.mintPosition=function(){var e=m(S.mark((function e(t,n,r,l,d,h,w,m,k){var v,O,I,T,x;return S.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===k&&(k=null),!this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return r<l||Object(c.default)(!1),null==(k=null!=k?k:this.payer)&&Object(c.default)(!1),v=f.Keypair.generate(),e.next=10,R(v.publicKey,k.publicKey);case 10:return O=e.sent,e.next=13,y.Token.getMinBalanceRentForExemptAccount(this.conn);case 13:return I=e.sent,null==(T=this.choosePosition())&&Object(c.default)(!1),(x=new f.Transaction).add(f.SystemProgram.createAccount({fromPubkey:k.publicKey,newAccountPubkey:v.publicKey,lamports:I,space:y.MintLayout.span,programId:y.TOKEN_PROGRAM_ID}),y.Token.createInitMintInstruction(y.TOKEN_PROGRAM_ID,v.publicKey,0,this.authority,null),F(v.publicKey,O,k.publicKey,k.publicKey)),x.add(X(this.programId,this.tokenSwapKey,this.authority,m.publicKey,t,n,this.tokenSwapInfo.swapTokenA,this.tokenSwapInfo.swapTokenB,v.publicKey,O,this.tokenSwapInfo.ticksKey,T,0,r,l,d,h,w,new o.a(0))),e.next=21,_(this.conn,x,k,m,v);case 21:return e.abrupt("return",e.sent);case 22:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,c,l,f,d,h){return e.apply(this,arguments)}}(),t.increaseLiquity=function(){var e=m(S.mark((function e(t,n,r,o,l,d,h){var w,m,k,v;return S.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===h&&(h=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null==(w=this.getPositionInfo(t))&&Object(c.default)(!1),null===(h=null!=h?h:this.payer)&&Object(c.default)(!1),m=new y.Token(this.conn,t,y.TOKEN_PROGRAM_ID,h),e.t0=m,e.next=12,R(m.publicKey,h.publicKey);case 12:return e.t1=e.sent,e.next=15,e.t0.getAccountInfo.call(e.t0,e.t1);case 15:return 1!==(k=e.sent).amount.toNumber()&&Object(c.default)(!1),(v=new f.Transaction).add(X(this.programId,this.tokenSwapKey,this.authority,h.publicKey,n,r,this.tokenSwapInfo.swapTokenA,this.tokenSwapInfo.swapTokenB,t,k.address,this.tokenSwapInfo.ticksKey,w.positionsKey,1,w.lowerTick,w.upperTick,o,l,d,w.index)),e.next=21,_(this.conn,v,h);case 21:return e.abrupt("return",e.sent);case 22:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,c,l,f){return e.apply(this,arguments)}}(),t.decreaseLiquity=function(){var e=m(S.mark((function e(t,n,r,o,l,d,h){var w,m,k,v;return S.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===h&&(h=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null==(w=this.getPositionInfo(t))&&Object(c.default)(!1),null===(h=null!=h?h:this.payer)&&Object(c.default)(!1),m=new y.Token(this.conn,t,y.TOKEN_PROGRAM_ID,h),e.t0=m,e.next=12,R(m.publicKey,h.publicKey);case 12:return e.t1=e.sent,e.next=15,e.t0.getAccountInfo.call(e.t0,e.t1);case 15:return 1!==(k=e.sent).amount.toNumber()&&Object(c.default)(!1),v=(new f.Transaction).add(ae(this.programId,this.tokenSwapKey,this.authority,h.publicKey,this.tokenSwapInfo.swapTokenA,this.tokenSwapInfo.swapTokenB,n,r,t,k.address,this.tokenSwapInfo.ticksKey,w.positionsKey,o,l,d,w.index)),e.next=20,_(this.conn,v,h);case 20:return e.abrupt("return",e.sent);case 21:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,c,l,f){return e.apply(this,arguments)}}(),t.swap=function(){var e=m(S.mark((function e(t,n,r,o,l,d,h){var y,w,m,k;return S.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===h&&(h=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null===(h=null!=h?h:this.payer)&&Object(c.default)(!1),y=1===r?{swapSrc:this.tokenSwapInfo.swapTokenA,swapDst:this.tokenSwapInfo.swapTokenB}:{swapSrc:this.tokenSwapInfo.swapTokenB,swapDst:this.tokenSwapInfo.swapTokenA},w=y.swapSrc,m=y.swapDst,k=(new f.Transaction).add(ie(this.programId,this.tokenSwapKey,this.authority,d.publicKey,t,n,w,m,this.tokenSwapInfo.ticksKey,o,l)),e.next=10,_(this.conn,k,h,d);case 10:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,c,l,f){return e.apply(this,arguments)}}(),t.simulateSwap=function(){var e=m(S.mark((function e(t,n,r){var o,c;return S.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isLoaded){e.next=3;break}return e.next=3,this.load();case 3:return o=(new f.Transaction).add(ue(this.programId,this.tokenSwapKey,this.tokenSwapInfo.ticksKey,t,n)),e.next=6,this.conn.simulateTransaction(o,[r]);case 6:c=e.sent,console.log(c);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.collect=function(){var e=m(S.mark((function e(t,n,r,o){var l,d,h,w;return S.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===o&&(o=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null==(l=this.getPositionInfo(t))&&Object(c.default)(!1),null===(o=null!=o?o:this.payer)&&Object(c.default)(!1),d=new y.Token(this.conn,t,y.TOKEN_PROGRAM_ID,o),e.t0=d,e.next=12,R(d.publicKey,o.publicKey);case 12:return e.t1=e.sent,e.next=15,e.t0.getAccountInfo.call(e.t0,e.t1);case 15:return 1!==(h=e.sent).amount.toNumber()&&Object(c.default)(!1),w=(new f.Transaction).add(Y(this.programId,this.tokenSwapKey,this.authority,o.publicKey,this.tokenSwapInfo.swapTokenB,this.tokenSwapInfo.swapTokenB,n,r,t,h.address,this.tokenSwapInfo.ticksKey,l.positionsKey,l.index)),e.next=20,_(this.conn,w,o);case 20:return e.abrupt("return",e.sent);case 21:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o){return e.apply(this,arguments)}}(),t.managerCollect=function(){var e=m(S.mark((function e(t,n,r){var o;return S.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null===(r=null!=r?r:this.payer)&&Object(c.default)(!1),o=(new f.Transaction).add(ne(this.programId,this.tokenSwapKey,this.authority,r.publicKey,this.tokenSwapInfo.swapTokenA,this.tokenSwapInfo.swapTokenB,t,n)),e.next=9,_(this.conn,o,r);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),t.addPositionsAccount=function(){var e=m(S.mark((function e(t){var n,r,o;return S.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=null),this.isLoaded){e.next=4;break}return e.next=4,this.load();case 4:return null===(t=null!=t?t:this.payer)&&Object(c.default)(!1),n=f.Keypair.generate(),e.next=9,this.conn.getMinimumBalanceForRentExemption(he);case 9:return r=e.sent,o=(new f.Transaction).add(f.SystemProgram.createAccount({fromPubkey:t.publicKey,newAccountPubkey:n.publicKey,lamports:r,space:he,programId:this.programId}),H(this.programId,this.authority,n.publicKey)),e.next=13,_(this.conn,o,t,n);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.approve=function(){var e=m(S.mark((function e(t,n,r,o,l){var f;return S.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===l&&(l=null),null===(l=null!=l?l:this.payer)&&Object(c.default)(!1),f=new y.Token(this.conn,n,y.TOKEN_PROGRAM_ID,l),e.next=6,f.approve(t,o.publicKey,l,[],r.toNumber());case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o,c){return e.apply(this,arguments)}}(),t.getUserPositions=function(){var e=m(S.mark((function e(t){var n,r,o,i,l;return S.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=void 0),this.isLoaded||Object(c.default)(!1),void 0===(t=null!=t?t:null==(n=this.payer)?void 0:n.publicKey)&&Object(c.default)(!1),e.next=6,C(this.conn,t);case 6:for(r=e.sent,o=[],i=0;i<r.length;i++)void 0!==(l=this.positions.get(r[i].mint.toBase58()))&&o.push(l);return e.abrupt("return",o);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.calculateLiquityByTokenA=function(e,t,n){if(this.isLoaded||Object(c.default)(!1),this.currentTick<=t||Object(c.default)(!1),this.currentTick<e)return{desiredAmountB:new o.a(0),liquity:We(e,t,n)};var r=qe(e,t,n,this.tokenSwapInfo.currentSqrtPrice,0);return{desiredAmountB:r.desiredAmountDst,liquity:r.deltaLiquity}},t.calculateLiquityByTokenB=function(e,t,n){if(this.isLoaded||Object(c.default)(!1),this.currentTick>=e||Object(c.default)(!1),this.currentTick<t)return{desiredAmountA:new o.a(0),liquity:Re(e,t,n)};var r=qe(e,t,n,this.tokenSwapInfo.currentSqrtPrice,1);return{desiredAmountA:r.desiredAmountDst,liquity:r.deltaLiquity}},t.calculatePositionValue=function(e){this.isLoaded||Object(c.default)(!1);var t=this.getPositionInfo(e);void 0===t&&Object(c.default)(!1);var n,r,l,f,d,h,y=(n=t.lowerTick,r=t.upperTick,l=t.liquity,f=this.tokenSwapInfo.currentSqrtPrice,d=Be(n),h=Be(r),f.lessThan(d)?{amountA:l.div(d).sub(l.div(h)),amountB:new o.a(0)}:f.greaterThan(h)?{amountA:new o.a(0),amountB:l.mul(h).sub(l.mul(d))}:{amountA:l.div(f).sub(l.div(h)),amountB:l.mul(f).sub(l.mul(d))}),w=y.amountA,m=y.amountB;return{liquity:t.liquity,amountA:w,amountB:m}},t.preCollect=function(e){this.isLoaded||Object(c.default)(!1);var t=this.getPositionInfo(e);void 0===t&&Object(c.default)(!1);for(var n=null,r=null,i=0;i<this.ticks.length;i++)this.ticks[i].tick==t.lowerTick&&(n=this.ticks[i]),this.ticks[i].tick==t.upperTick&&(r=this.ticks[i]);null===n&&Object(c.default)(!1),null===r&&Object(c.default)(!1);var l=new o.a(0),f=new o.a(0),d=new o.a(0),h=new o.a(0),y=this.tokenSwapInfo.currentSqrtPrice;return n.tickPrice.lessThan(y)?(l=n.feeGrowthOutside0,f=n.feeGrowthOutside1):(l=this.tokenSwapInfo.feeGrowthGlobal0.sub(n.feeGrowthOutside0),f=this.tokenSwapInfo.feeGrowthGlobal1.sub(n.feeGrowthOutside1)),r.tickPrice.lessThan(y)?(d=this.tokenSwapInfo.feeGrowthGlobal0.sub(r.feeGrowthOutside0),h=this.tokenSwapInfo.feeGrowthGlobal1.sub(r.feeGrowthOutside1)):(d=r.feeGrowthOutside0,h=r.feeGrowthOutside1),{amountA:this.tokenSwapInfo.feeGrowthGlobal0.sub(l).sub(d).sub(t.feeGrowthInsideALast).mul(t.liquity),amountB:this.tokenSwapInfo.feeGrowthGlobal1.sub(f).sub(h).sub(t.feeGrowthInsideBLast).mul(t.liquity)}},t.preSwapA=function(e){this.isLoaded||Object(c.default)(!1);var t=function(e,t,n,o,l){l.greaterThan(new r.Decimal(0))||Object(c.default)(!1),o.greaterThanOrEqualTo(new r.Decimal(0))||Object(c.default)(!1),e.length>0||Object(c.default)(!1),t>e[0].tickPrice||Object(c.default)(!1);for(var f=o,d=new r.Decimal(0),h=l,y=new r.Decimal(0),w=new r.Decimal(0),m=new r.Decimal(0),i=e.length-1;i>=0;i--)if(f.equals(new r.Decimal(0)))t=e[i].tickPrice.sub(Ee),f=f.sub(e[i].liquityNet);else if(!(t<e[i].tickPrice)){var k=t,v=e[i].tickPrice,S=Ue(v,t,f),O=S.mul(n).toDP(0,r.Decimal.ROUND_DOWN);if(y=h.lessThan(O)?h:h.sub(O),S.greaterThanOrEqualTo(y)){var I=Ge(k,f,y=h.mul(new r.Decimal(1).sub(n)).toDP(0,r.Decimal.ROUND_UP)),T=I.amountOut,x=I.afterSqrtPrice;return m=m.add(h),w=w.add(h.sub(y)),{amountOut:d.add(T),amountUsed:m,feeUsed:w,afterPrice:x,afterLiquity:f}}h=y.sub(S),m=m.add(S).add(O),w=w.add(O),d=d.add(Ne(v,k,f)),f=f.sub(e[i].liquityNet),t=e[i].tickPrice.sub(Ee)}return{amountOut:d,amountUsed:m,feeUsed:w,afterPrice:t,afterLiquity:f}}(this.ticks,this.tokenSwapInfo.currentSqrtPrice,this.tokenSwapInfo.fee,this.tokenSwapInfo.currentLiquity,e),n=this.tokenSwapInfo.currentSqrtPrice.pow(2),l=t.afterPrice.pow(2),f=l.sub(n).div(n).abs(),d=new o.a(1),h=d.div(n),y=d.div(l).sub(h).div(h).abs();return{amountOut:t.amountOut,amountUsed:t.amountUsed,feeUsed:t.feeUsed,afterPrice:t.afterPrice,afterLiquity:t.afterLiquity,impactA:f,impactB:y}},t.preSwapB=function(e){this.isLoaded||Object(c.default)(!1);var t=function(e,t,n,o,l){l.greaterThan(new r.Decimal(0))||Object(c.default)(!1),o.greaterThanOrEqualTo(new r.Decimal(0))||Object(c.default)(!1),e.length>0||Object(c.default)(!1),t.lessThan(e[e.length-1].tickPrice)||Object(c.default)(!1);for(var f=o,d=new r.Decimal(0),h=l,y=new r.Decimal(0),w=new r.Decimal(0),m=new r.Decimal(0),i=0;i<e.length;i++)if(f.equals(new r.Decimal(0)))t=e[i].tickPrice.add(Ee),f=f.add(e[i].liquityNet);else if(!(t>e[i].tickPrice)){var k=e[i].tickPrice,v=Ne(t,k,f),S=v.mul(n).toDP(0,r.Decimal.ROUND_DOWN);if(y=h.lessThan(S)?h:h.sub(S),v.greaterThanOrEqualTo(y)){var O=_e(t,f,y=h.mul(new r.Decimal(1).sub(n)).toDP(0,r.Decimal.ROUND_UP)),I=O.amountOut,T=O.afterSqrtPrice;return w=w.add(h),m=m.add(h.sub(y)),{amountOut:d.add(I),feeUsed:m,amountUsed:w,afterPrice:T.pow(2),afterLiquity:f}}h=y.sub(v),w=w.add(v).add(S),m=m.add(S),d=d.add(Ue(t,k,f)),f=f.add(e[i].liquityNet),t=e[i].tickPrice.add(Ee)}return{amountOut:d,amountUsed:w,feeUsed:m,afterPrice:t,afterLiquity:f}}(this.ticks,this.tokenSwapInfo.currentSqrtPrice,this.tokenSwapInfo.fee,this.tokenSwapInfo.currentLiquity,e),n=this.tokenSwapInfo.currentSqrtPrice.pow(2),l=t.afterPrice.pow(2),f=l.sub(n).div(n).abs(),d=new o.a(1),h=d.div(n),y=d.div(l).sub(h).div(h).abs();return{amountOut:t.amountOut,amountUsed:t.amountUsed,feeUsed:t.feeUsed,afterPrice:t.afterPrice,afterLiquity:t.afterLiquity,impactA:f,impactB:y}},t.getNearestTickByPrice=function(e){return this.isLoaded||Object(c.default)(!1),Ke(e,this.tokenSwapInfo.tickSpace)},t.getPositionInfo=function(e){return this.isLoaded||Object(c.default)(!1),this.positions.get(e.toBase58())},t.choosePosition=function(){this.isLoaded||Object(c.default)(!1);for(var e,t=v(this.positionsKeys);!(e=t()).done;){var n=e.value,r=n[0];if(n[1]<we)return r}return null},t.log=function(){var e=null!==this.payer?this.payer.publicKey.toBase58():"null";console.log(JSON.stringify({programId:this.programId.toString(),tokenSwapKey:this.tokenSwapKey.toString(),payer:e,authority:this.authority.toString(),currentTick:this.currentTick,currentPrice:this.tokenSwapInfo.currentSqrtPrice.pow(2).toString(),tokenSwapInfo:{accountType:this.tokenSwapInfo.accountType,version:this.tokenSwapInfo.version,isInitialized:this.tokenSwapInfo.isInitialized,nonce:this.tokenSwapInfo.nonce,manager:this.tokenSwapInfo.manager.toString(),managerTokenA:this.tokenSwapInfo.managerTokenA.toString(),managerTokenB:this.tokenSwapInfo.managerTokenB.toString(),swapTokenA:this.tokenSwapInfo.swapTokenA.toString(),swapTokenB:this.tokenSwapInfo.swapTokenB.toString(),tokenAMint:this.tokenSwapInfo.tokenAMint.toString(),tokenBMint:this.tokenSwapInfo.tokenBMint.toString(),ticksKey:this.tokenSwapInfo.ticksKey.toString(),positionsKey:this.tokenSwapInfo.positionsKey.toString(),curveType:this.tokenSwapInfo.curveType,fee:this.tokenSwapInfo.fee,managerFee:this.tokenSwapInfo.managerFee,tickSpace:this.tokenSwapInfo.tickSpace,currentSqrtPrice:this.tokenSwapInfo.currentSqrtPrice,currentLiquity:this.tokenSwapInfo.currentLiquity,feeGrowthGlobal0:this.tokenSwapInfo.feeGrowthGlobal0,feeGrowthGlobal1:this.tokenSwapInfo.feeGrowthGlobal1,managerFeeA:this.tokenSwapInfo.managerFeeA,managerFeeB:this.tokenSwapInfo.managerFeeB},positions:Object.fromEntries(this.positions),positionsKeys:Object.fromEntries(this.positionsKeys),ticks:this.ticks},null,4))},e}()}).call(this,n(5).Buffer)},1984:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.s16=t.s8=t.nu64be=t.u48be=t.u40be=t.u32be=t.u24be=t.u16be=t.nu64=t.u48=t.u40=t.u32=t.u24=t.u16=t.u8=t.offset=t.greedy=t.Constant=t.UTF8=t.CString=t.Blob=t.Boolean=t.BitField=t.BitStructure=t.VariantLayout=t.Union=t.UnionLayoutDiscriminator=t.UnionDiscriminator=t.Structure=t.Sequence=t.DoubleBE=t.Double=t.FloatBE=t.Float=t.NearInt64BE=t.NearInt64=t.NearUInt64BE=t.NearUInt64=t.IntBE=t.Int=t.UIntBE=t.UInt=t.OffsetLayout=t.GreedyCount=t.ExternalLayout=t.bindConstructorLayout=t.nameWithProperty=t.Layout=t.uint8ArrayToBuffer=t.checkUint8Array=void 0,t.constant=t.utf8=t.cstr=t.blob=t.unionLayoutDiscriminator=t.union=t.seq=t.bits=t.struct=t.f64be=t.f64=t.f32be=t.f32=t.ns64be=t.s48be=t.s40be=t.s32be=t.s24be=t.s16be=t.ns64=t.s48=t.s40=t.s32=t.s24=void 0;const r=n(5);function o(b){if(!(b instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}function c(b){return o(b),r.Buffer.from(b.buffer,b.byteOffset,b.length)}t.checkUint8Array=o,t.uint8ArrayToBuffer=c;class l{constructor(span,e){if(!Number.isInteger(span))throw new TypeError("span must be an integer");this.span=span,this.property=e}makeDestinationObject(){return{}}getSpan(b,e){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}function f(e,t){return t.property?e+"["+t.property+"]":e}t.Layout=l,t.nameWithProperty=f,t.bindConstructorLayout=function(e,t){if("function"!=typeof e)throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(e,"layout_"))throw new Error("Class is already bound to a layout");if(!(t&&t instanceof l))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(t,"boundConstructor_"))throw new Error("layout is already bound to a constructor");e.layout_=t,t.boundConstructor_=e,t.makeDestinationObject=()=>new e,Object.defineProperty(e.prototype,"encode",{value(b,e){return t.encode(this,b,e)},writable:!0}),Object.defineProperty(e,"decode",{value:(b,e)=>t.decode(b,e),writable:!0})};class d extends l{isCount(){throw new Error("ExternalLayout is abstract")}}t.ExternalLayout=d;class h extends d{constructor(e=1,t){if(!Number.isInteger(e)||0>=e)throw new TypeError("elementSpan must be a (positive) integer");super(-1,t),this.elementSpan=e}isCount(){return!0}decode(b,e=0){o(b);const t=b.length-e;return Math.floor(t/this.elementSpan)}encode(e,b,t){return 0}}t.GreedyCount=h;class y extends d{constructor(e,t=0,n){if(!(e instanceof l))throw new TypeError("layout must be a Layout");if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,n||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof w||this.layout instanceof m}decode(b,e=0){return this.layout.decode(b,e+this.offset)}encode(e,b,t=0){return this.layout.encode(e,b,t+this.offset)}}t.OffsetLayout=y;class w extends l{constructor(span,e){if(super(span,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(b,e=0){return c(b).readUIntLE(e,this.span)}encode(e,b,t=0){return c(b).writeUIntLE(e,t,this.span),this.span}}t.UInt=w;class m extends l{constructor(span,e){if(super(span,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(b,e=0){return c(b).readUIntBE(e,this.span)}encode(e,b,t=0){return c(b).writeUIntBE(e,t,this.span),this.span}}t.UIntBE=m;class k extends l{constructor(span,e){if(super(span,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(b,e=0){return c(b).readIntLE(e,this.span)}encode(e,b,t=0){return c(b).writeIntLE(e,t,this.span),this.span}}t.Int=k;class v extends l{constructor(span,e){if(super(span,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(b,e=0){return c(b).readIntBE(e,this.span)}encode(e,b,t=0){return c(b).writeIntBE(e,t,this.span),this.span}}t.IntBE=v;const S=Math.pow(2,32);function O(e){const t=Math.floor(e/S);return{hi32:t,lo32:e-t*S}}function I(e,t){return e*S+t}class T extends l{constructor(e){super(8,e)}decode(b,e=0){const t=c(b),n=t.readUInt32LE(e);return I(t.readUInt32LE(e+4),n)}encode(e,b,t=0){const n=O(e),r=c(b);return r.writeUInt32LE(n.lo32,t),r.writeUInt32LE(n.hi32,t+4),8}}t.NearUInt64=T;class x extends l{constructor(e){super(8,e)}decode(b,e=0){const t=c(b);return I(t.readUInt32BE(e),t.readUInt32BE(e+4))}encode(e,b,t=0){const n=O(e),r=c(b);return r.writeUInt32BE(n.hi32,t),r.writeUInt32BE(n.lo32,t+4),8}}t.NearUInt64BE=x;class E extends l{constructor(e){super(8,e)}decode(b,e=0){const t=c(b),n=t.readUInt32LE(e);return I(t.readInt32LE(e+4),n)}encode(e,b,t=0){const n=O(e),r=c(b);return r.writeUInt32LE(n.lo32,t),r.writeInt32LE(n.hi32,t+4),8}}t.NearInt64=E;class j extends l{constructor(e){super(8,e)}decode(b,e=0){const t=c(b);return I(t.readInt32BE(e),t.readUInt32BE(e+4))}encode(e,b,t=0){const n=O(e),r=c(b);return r.writeInt32BE(n.hi32,t),r.writeUInt32BE(n.lo32,t+4),8}}t.NearInt64BE=j;class A extends l{constructor(e){super(4,e)}decode(b,e=0){return c(b).readFloatLE(e)}encode(e,b,t=0){return c(b).writeFloatLE(e,t),4}}t.Float=A;class P extends l{constructor(e){super(4,e)}decode(b,e=0){return c(b).readFloatBE(e)}encode(e,b,t=0){return c(b).writeFloatBE(e,t),4}}t.FloatBE=P;class L extends l{constructor(e){super(8,e)}decode(b,e=0){return c(b).readDoubleLE(e)}encode(e,b,t=0){return c(b).writeDoubleLE(e,t),8}}t.Double=L;class D extends l{constructor(e){super(8,e)}decode(b,e=0){return c(b).readDoubleBE(e)}encode(e,b,t=0){return c(b).writeDoubleBE(e,t),8}}t.DoubleBE=D;class B extends l{constructor(e,t,n){if(!(e instanceof l))throw new TypeError("elementLayout must be a Layout");if(!(t instanceof d&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let span=-1;!(t instanceof d)&&0<e.span&&(span=t*e.span),super(span,n),this.elementLayout=e,this.count=t}getSpan(b,e=0){if(0<=this.span)return this.span;let span=0,t=this.count;if(t instanceof d&&(t=t.decode(b,e)),0<this.elementLayout.span)span=t*this.elementLayout.span;else{let n=0;for(;n<t;)span+=this.elementLayout.getSpan(b,e+span),++n}return span}decode(b,e=0){const t=[];let i=0,n=this.count;for(n instanceof d&&(n=n.decode(b,e));i<n;)t.push(this.elementLayout.decode(b,e)),e+=this.elementLayout.getSpan(b,e),i+=1;return t}encode(e,b,t=0){const n=this.elementLayout,span=e.reduce(((span,e)=>span+n.encode(e,b,t+span)),0);return this.count instanceof d&&this.count.encode(e.length,b,t),span}}t.Sequence=B;class K extends l{constructor(e,t,n){if(!Array.isArray(e)||!e.reduce(((e,t)=>e&&t instanceof l),!0))throw new TypeError("fields must be array of Layout instances");"boolean"==typeof t&&void 0===n&&(n=t,t=void 0);for(const t of e)if(0>t.span&&void 0===t.property)throw new Error("fields cannot contain unnamed variable-length layout");let span=-1;try{span=e.reduce(((span,e)=>span+e.getSpan()),0)}catch(e){}super(span,t),this.fields=e,this.decodePrefixes=!!n}getSpan(b,e=0){if(0<=this.span)return this.span;let span=0;try{span=this.fields.reduce(((span,t)=>{const n=t.getSpan(b,e);return e+=n,span+n}),0)}catch(e){throw new RangeError("indeterminate span")}return span}decode(b,e=0){o(b);const t=this.makeDestinationObject();for(const n of this.fields)if(void 0!==n.property&&(t[n.property]=n.decode(b,e)),e+=n.getSpan(b,e),this.decodePrefixes&&b.length===e)break;return t}encode(e,b,t=0){const n=t;let r=0,o=0;for(const n of this.fields){let span=n.span;if(o=0<span?span:0,void 0!==n.property){const r=e[n.property];void 0!==r&&(o=n.encode(r,b,t),0>span&&(span=n.getSpan(b,t)))}r=t,t+=span}return r+o-n}fromArray(e){const t=this.makeDestinationObject();for(const n of this.fields)void 0!==n.property&&0<e.length&&(t[n.property]=e.shift());return t}layoutFor(e){if("string"!=typeof e)throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if("string"!=typeof e)throw new TypeError("property must be string");let t=0;for(const n of this.fields){if(n.property===e)return t;0>n.span?t=-1:0<=t&&(t+=n.span)}}}t.Structure=K;class U{constructor(e){this.property=e}decode(b,e){throw new Error("UnionDiscriminator is abstract")}encode(e,b,t){throw new Error("UnionDiscriminator is abstract")}}t.UnionDiscriminator=U;class N extends U{constructor(e,t){if(!(e instanceof d&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(b,e){return this.layout.decode(b,e)}encode(e,b,t){return this.layout.encode(e,b,t)}}t.UnionLayoutDiscriminator=N;class G extends l{constructor(e,t,n){let r;if(e instanceof w||e instanceof m)r=new N(new y(e));else if(e instanceof d&&e.isCount())r=new N(e);else{if(!(e instanceof U))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");r=e}if(void 0===t&&(t=null),!(null===t||t instanceof l))throw new TypeError("defaultLayout must be null or a Layout");if(null!==t){if(0>t.span)throw new Error("defaultLayout must have constant span");void 0===t.property&&(t=t.replicate("content"))}let span=-1;t&&(span=t.span,0<=span&&(e instanceof w||e instanceof m)&&(span+=r.layout.span)),super(span,n),this.discriminator=r,this.usesPrefixDiscriminator=e instanceof w||e instanceof m,this.defaultLayout=t,this.registry={};let o=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(e){return o(e)},this.configGetSourceVariant=function(e){o=e.bind(this)}}getSpan(b,e=0){if(0<=this.span)return this.span;const t=this.getVariant(b,e);if(!t)throw new Error("unable to determine span for unrecognized variant");return t.getSpan(b,e)}defaultGetSourceVariant(e){if(Object.prototype.hasOwnProperty.call(e,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(e,this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||t.property&&Object.prototype.hasOwnProperty.call(e,t.property)))return t}else for(const t in this.registry){const n=this.registry[t];if(n.property&&Object.prototype.hasOwnProperty.call(e,n.property))return n}throw new Error("unable to infer src variant")}decode(b,e=0){let t;const n=this.discriminator,r=n.decode(b,e),o=this.registry[r];if(void 0===o){const o=this.defaultLayout;let c=0;this.usesPrefixDiscriminator&&(c=n.layout.span),t=this.makeDestinationObject(),t[n.property]=r,t[o.property]=o.decode(b,e+c)}else t=o.decode(b,e);return t}encode(e,b,t=0){const n=this.getSourceVariant(e);if(void 0===n){const n=this.discriminator,r=this.defaultLayout;let o=0;return this.usesPrefixDiscriminator&&(o=n.layout.span),n.encode(e[n.property],b,t),o+r.encode(e[r.property],b,t+o)}return n.encode(e,b,t)}addVariant(e,t,n){const r=new _(this,e,t,n);return this.registry[e]=r,r}getVariant(e,t=0){let n;return n=e instanceof Uint8Array?this.discriminator.decode(e,t):e,this.registry[n]}}t.Union=G;class _ extends l{constructor(e,t,n,r){if(!(e instanceof G))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if("string"==typeof n&&void 0===r&&(r=n,n=null),n){if(!(n instanceof l))throw new TypeError("layout must be a Layout");if(null!==e.defaultLayout&&0<=n.span&&n.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if("string"!=typeof r)throw new TypeError("variant must have a String property")}let span=e.span;0>e.span&&(span=n?n.span:0,0<=span&&e.usesPrefixDiscriminator&&(span+=e.discriminator.layout.span)),super(span,r),this.union=e,this.variant=t,this.layout=n||null}getSpan(b,e=0){if(0<=this.span)return this.span;let t=0;this.union.usesPrefixDiscriminator&&(t=this.union.discriminator.layout.span);let span=0;return this.layout&&(span=this.layout.getSpan(b,e+t)),t+span}decode(b,e=0){const t=this.makeDestinationObject();if(this!==this.union.getVariant(b,e))throw new Error("variant mismatch");let n=0;return this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),this.layout?t[this.property]=this.layout.decode(b,e+n):this.property?t[this.property]=!0:this.union.usesPrefixDiscriminator&&(t[this.union.discriminator.property]=this.variant),t}encode(e,b,t=0){let n=0;if(this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(e,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,b,t);let span=n;if(this.layout&&(this.layout.encode(e[this.property],b,t+n),span+=this.layout.getSpan(b,t+n),0<=this.union.span&&span>this.union.span))throw new Error("encoded variant overruns containing union");return span}fromArray(e){if(this.layout)return this.layout.fromArray(e)}}function W(e){return 0>e&&(e+=4294967296),e}t.VariantLayout=_;class R extends l{constructor(e,t,n){if(!(e instanceof w||e instanceof m))throw new TypeError("word must be a UInt or UIntBE layout");if("string"==typeof t&&void 0===n&&(n=t,t=!1),4<e.span)throw new RangeError("word cannot exceed 32 bits");super(e.span,n),this.word=e,this.msb=!!t,this.fields=[];let r=0;this._packedSetValue=function(e){return r=W(e),this},this._packedGetValue=function(){return r}}decode(b,e=0){const t=this.makeDestinationObject(),n=this.word.decode(b,e);this._packedSetValue(n);for(const e of this.fields)void 0!==e.property&&(t[e.property]=e.decode(b));return t}encode(e,b,t=0){const n=this.word.decode(b,t);this._packedSetValue(n);for(const t of this.fields)if(void 0!==t.property){const n=e[t.property];void 0!==n&&t.encode(n)}return this.word.encode(this._packedGetValue(),b,t)}addField(e,t){const n=new M(this,e,t);return this.fields.push(n),n}addBoolean(e){const t=new F(this,e);return this.fields.push(t),t}fieldFor(e){if("string"!=typeof e)throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}}t.BitStructure=R;class M{constructor(e,t,n){if(!(e instanceof R))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(t)||0>=t)throw new TypeError("bits must be positive integer");const r=8*e.span,o=e.fields.reduce(((e,t)=>e+t.bits),0);if(t+o>r)throw new Error("bits too long for span remainder ("+(r-o)+" of "+r+" remain)");this.container=e,this.bits=t,this.valueMask=(1<<t)-1,32===t&&(this.valueMask=4294967295),this.start=o,this.container.msb&&(this.start=r-o-t),this.wordMask=W(this.valueMask<<this.start),this.property=n}decode(b,e){return W(this.container._packedGetValue()&this.wordMask)>>>this.start}encode(e){if("number"!=typeof e||!Number.isInteger(e)||e!==W(e&this.valueMask))throw new TypeError(f("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const t=this.container._packedGetValue(),n=W(e<<this.start);this.container._packedSetValue(W(t&~this.wordMask)|n)}}t.BitField=M;class F extends M{constructor(e,t){super(e,1,t)}decode(b,e){return!!super.decode(b,e)}encode(e){"boolean"==typeof e&&(e=+e),super.encode(e)}}t.Boolean=F;class C extends l{constructor(e,t){if(!(e instanceof d&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let span=-1;e instanceof d||(span=e),super(span,t),this.length=e}getSpan(b,e){let span=this.span;return 0>span&&(span=this.length.decode(b,e)),span}decode(b,e=0){let span=this.span;return 0>span&&(span=this.length.decode(b,e)),c(b).slice(e,e+span)}encode(e,b,t){let span=this.length;if(this.length instanceof d&&(span=e.length),!(e instanceof Uint8Array&&span===e.length))throw new TypeError(f("Blob.encode",this)+" requires (length "+span+") Uint8Array as src");if(t+span>b.length)throw new RangeError("encoding overruns Uint8Array");const n=c(e);return c(b).write(n.toString("hex"),t,span,"hex"),this.length instanceof d&&this.length.encode(span,b,t),span}}t.Blob=C;class V extends l{constructor(e){super(-1,e)}getSpan(b,e=0){o(b);let t=e;for(;t<b.length&&0!==b[t];)t+=1;return 1+t-e}decode(b,e=0){const span=this.getSpan(b,e);return c(b).slice(e,e+span-1).toString("utf-8")}encode(e,b,t=0){"string"!=typeof e&&(e=String(e));const n=r.Buffer.from(e,"utf8"),span=n.length;if(t+span>b.length)throw new RangeError("encoding overruns Buffer");const o=c(b);return n.copy(o,t),o[t+span]=0,span+1}}t.CString=V;class z extends l{constructor(e,t){if("string"==typeof e&&void 0===t&&(t=e,e=void 0),void 0===e)e=-1;else if(!Number.isInteger(e))throw new TypeError("maxSpan must be an integer");super(-1,t),this.maxSpan=e}getSpan(b,e=0){return o(b),b.length-e}decode(b,e=0){const span=this.getSpan(b,e);if(0<=this.maxSpan&&this.maxSpan<span)throw new RangeError("text length exceeds maxSpan");return c(b).slice(e,e+span).toString("utf-8")}encode(e,b,t=0){"string"!=typeof e&&(e=String(e));const n=r.Buffer.from(e,"utf8"),span=n.length;if(0<=this.maxSpan&&this.maxSpan<span)throw new RangeError("text length exceeds maxSpan");if(t+span>b.length)throw new RangeError("encoding overruns Buffer");return n.copy(c(b),t),span}}t.UTF8=z;class $ extends l{constructor(e,t){super(0,t),this.value=e}decode(b,e){return this.value}encode(e,b,t){return 0}}t.Constant=$,t.greedy=(e,t)=>new h(e,t),t.offset=(e,t,n)=>new y(e,t,n),t.u8=e=>new w(1,e),t.u16=e=>new w(2,e),t.u24=e=>new w(3,e),t.u32=e=>new w(4,e),t.u40=e=>new w(5,e),t.u48=e=>new w(6,e),t.nu64=e=>new T(e),t.u16be=e=>new m(2,e),t.u24be=e=>new m(3,e),t.u32be=e=>new m(4,e),t.u40be=e=>new m(5,e),t.u48be=e=>new m(6,e),t.nu64be=e=>new x(e),t.s8=e=>new k(1,e),t.s16=e=>new k(2,e),t.s24=e=>new k(3,e),t.s32=e=>new k(4,e),t.s40=e=>new k(5,e),t.s48=e=>new k(6,e),t.ns64=e=>new E(e),t.s16be=e=>new v(2,e),t.s24be=e=>new v(3,e),t.s32be=e=>new v(4,e),t.s40be=e=>new v(5,e),t.s48be=e=>new v(6,e),t.ns64be=e=>new j(e),t.f32=e=>new A(e),t.f32be=e=>new P(e),t.f64=e=>new L(e),t.f64be=e=>new D(e),t.struct=(e,t,n)=>new K(e,t,n),t.bits=(e,t,n)=>new R(e,t,n),t.seq=(e,t,n)=>new B(e,t,n),t.union=(e,t,n)=>new G(e,t,n),t.unionLayoutDiscriminator=(e,t)=>new N(e,t),t.blob=(e,t)=>new C(e,t),t.cstr=e=>new V(e),t.utf8=(e,t)=>new z(e,t),t.constant=(e,t)=>new $(e,t)},2055:function(e,t,n){"use strict";var r=n(227),o=n(518),c=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,l=/^\w*$/;var f=function(e,object){if(Object(r.a)(e))return!1;var t=typeof e;return!("number"!=t&&"symbol"!=t&&"boolean"!=t&&null!=e&&!Object(o.a)(e))||(l.test(e)||!c.test(e)||null!=object&&e in Object(object))},d=n(522);function h(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],c=n.cache;if(c.has(o))return c.get(o);var l=e.apply(this,r);return n.cache=c.set(o,l)||c,l};return n.cache=new(h.Cache||d.a),n}h.Cache=d.a;var y=h;var w=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,m=/\\(\\)?/g,k=function(e){var t=y(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(w,(function(e,n,r,o){t.push(r?o.replace(m,"$1"):n||e)})),t})),v=n(169);var S=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o},O=v.a?v.a.prototype:void 0,I=O?O.toString:void 0;var T=function e(t){if("string"==typeof t)return t;if(Object(r.a)(t))return S(t,e)+"";if(Object(o.a)(t))return I?I.call(t):"";var n=t+"";return"0"==n&&1/t==-Infinity?"-0":n};var x=function(e){return null==e?"":T(e)};var E=function(e,object){return Object(r.a)(e)?e:f(e,object)?[e]:k(x(e))};var j=function(e){if("string"==typeof e||Object(o.a)(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t};var A=function(object,path){for(var e=0,t=(path=E(path,object)).length;null!=object&&e<t;)object=object[j(path[e++])];return e&&e==t?object:void 0};t.a=function(object,path,e){var t=null==object?void 0:A(object,path);return void 0===t?e:t}}}]);